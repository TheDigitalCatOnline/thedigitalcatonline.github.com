<!DOCTYPE HTML>
<!--
	Editorial by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
	<head>
        <title>Exploring the Amiga - Part 8 - The Digital Cat</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
<meta name="description" content="Branching in the M68k Assembly, memory list management in Kickstart 1.3">
<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@thedigicat" />
<meta name="twitter:title" content="Exploring the Amiga - Part 8" />
<meta name="twitter:description" content="Branching in the M68k Assembly, memory list management in Kickstart 1.3" />
<meta name="twitter:image" content="https://www.thedigitalcatonline.com/images/exploring-the-amiga-8.jpg" />
		<script src="https://kit.fontawesome.com/15214b60ba.js" crossorigin="anonymous"></script>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,600,400italic,600italic|Roboto+Slab:400,700">

        <link rel="stylesheet" href="/theme/css/main.min.css?59943907">

<link rel="stylesheet" href="/theme/css/retro.min.css?d93687f1">
        
        <link href="/images/global/favicon.jpg" rel="icon">

        <!-- Google Analytics Universal -->
        <script type="text/javascript">
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
            ga('create', 'UA-74364524-1', 'auto');
            ga('send', 'pageview');
        </script>
        <!-- End Google Analytics Universal Code -->

<script type="application/ld+json">
  {
      "@context" : "https://schema.org",
      "@type" : "Article",
      "name" : "Exploring the Amiga - Part 8",
      "author" : {
	  "@type" : "Person",
	  "name" : "Leonardo Giordani"
      },
      "publisher" : {
	  "@type" : "Organization",
	  "name" : "The Digital Cat",
	  "logo" : {
	      "@type" : "ImageObject",
	      "url" : "https://www.thedigitalcatonline.com/images/global/logo_200.jpg",
	      "height" : 200,
	      "width" : 200
	  }
      },
      "mainEntityOfPage": {
	  "@type": "WebPage",
	  "@id": "https://www.thedigitalcatonline.com/blog/2019/02/19/exploring-the-amiga-8/"
      },
      "datePublished" : "19/02/2019",
      "dateModified" : "19/02/2019",
      "image" : "https://www.thedigitalcatonline.com/images/exploring-the-amiga-8.jpg",
      "description" : "Branching in the M68k Assembly, memory list management in Kickstart 1.3",
      "headline" : "Branching in the M68k Assembly, memory list management in Kickstart 1.3",
      "url" : "https://www.thedigitalcatonline.com/blog/2019/02/19/exploring-the-amiga-8/"
  }
</script>
	</head>
	<body class="is-preload">

		<!-- Wrapper -->
			<div id="wrapper">

				<!-- Main -->
					<div id="main">
						<div class="inner">

<header id="header">
  <a class="logo" href="/category/retro/" title="Retro">All posts in category Retro <i class="fas fa-link"></i></a>
  <div class="align-right">

    <a href="/blog/2019/02/19/exploring-the-amiga-7/"><i class="fas fa-caret-square-left"></i></a>
    
    Exploring the Amiga #8


  </div>
</header>

<!-- <article class="post"> -->

  <section id="header">
    <header class="main">
      <h1>Exploring the Amiga - Part 8</h1>
    </header>
  </section>

  <section id="post-info">
    <p class="article-info">
    By Leonardo Giordani

    <span class="fas fa-calendar-alt"></span> <time datetime="2019-02-19T14:00:00+01:00"> 19/02/2019</time>


    <span class="fas fa-tags"></span>
    <a class="tag" href="/categories/assembly/">assembly</a>    <a class="tag" href="/categories/amiga/">amiga</a>    <a class="tag" href="/categories/retroprogramming/">retroprogramming</a>    <br>
    Share on: <span><a class="" href="https://twitter.com/intent/tweet?text=Exploring%20the%20Amiga%20-%20Part%208&url=https%3A//www.thedigitalcatonline.com/blog/2019/02/19/exploring-the-amiga-8/&via=thedigicat&hashtags=assembly,amiga,retroprogramming" target="_blank" title="Share on Twitter"><i class="fab fa-twitter"></i> Twitter</a></span>
<span><a class="" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A//www.thedigitalcatonline.com/blog/2019/02/19/exploring-the-amiga-8/&title=Exploring%20the%20Amiga%20-%20Part%208&summary=Branching%20in%20the%20M68k%20Assembly%2C%20memory%20list%20management%20in%20Kickstart%201.3&source=https%3A//www.thedigitalcatonline.com/blog/2019/02/19/exploring-the-amiga-8/" target="_blank" title="Share on LinkedIn"><i class="fab fa-linkedin"></i> LinkedIn</a></span>
<span><a class="" href="https://news.ycombinator.com/submitlink?t=Exploring%20the%20Amiga%20-%20Part%208&u=https%3A//www.thedigitalcatonline.com/blog/2019/02/19/exploring-the-amiga-8/" target="_blank" title="Share on HackerNews"><i class="fab fa-hacker-news"></i> HackerNews</a></span>
<span><a class="" href="mailto:?subject=Exploring%20the%20Amiga%20-%20Part%208&amp;body=https%3A//www.thedigitalcatonline.com/blog/2019/02/19/exploring-the-amiga-8/" target="_blank" title="Share via Email"><i class="fas fa-envelope"></i> Email</a></span>
<span><a class="" href="https://www.reddit.com/submit?url=https%3A//www.thedigitalcatonline.com/blog/2019/02/19/exploring-the-amiga-8/&title=Exploring%20the%20Amiga%20-%20Part%208" target="_blank" title="Share via Reddit"><i class="fab fa-reddit"></i> Reddit</a></span>    </p>
  </section>

  <section id="content">
    <h1 id="branching">Branching<a class="headerlink" href="#branching" title="Permanent link">&para;</a></h1>
<p>As branching is one of the most important ways to control the program flow it is worth discussing how it works in the Motorola 68000 processor, and review what options we have.</p>
<p>Contrary to what happens in higher level languages, in Assembly we do not have a way to represent logical expressions. In a language like C we can compare two integers with something like <code>a &gt; b</code> which tells us if the first number is greater than the second. But in Assembly there is no such syntax, so we have to rely on processor flags; these are bits that the processor sets according to the result of some operation, be it a direct comparison of two values or another instruction that manages integer numbers.</p>
<p>The Motorola 68000 flags are kept in the 5 least significant bits of the Status Register (SR). The latter is not available during the normal operations in user mode, but these 5 bits, called Condition Code Register (CCR) are always accessible. The 5 bits are named <code>X</code>, <code>N</code>, <code>Z</code>, <code>V</code>, and <code>C</code>. Of these, the ones we need to take into consideration for branching are the rightmost 4.</p>
<ul>
<li><code>N</code> (Negative) is set to the value of the most significant bit of the result of an instruction, to show that a negative number was produced.</li>
<li><code>Z</code> (Zero) is set if the result is zero.</li>
<li><code>V</code> (Overflow) is set when an arithmetic operation results in a number that cannot be represented with the size of the operand.</li>
<li><code>C</code> (Carry) is set when an addition or a subtraction need to carry a bit (carry out or borrow).</li>
</ul>
<p>To branch according to the value of these flags we can use the <code>Bcc</code> family of instruction, where <code>cc</code> is a two-letter mnemonic that represents the condition that is under test. For example the condition <code>MI</code> stands for <code>MInus</code> and tests if the <code>N</code> flag is set. Thus, <code>bmi &lt;address&gt;</code> will branch to <code>&lt;address&gt;</code> if the result of the previous instruction was negative, because that instruction set the <code>N</code> flag.</p>
<p>There are multiple families of instructions that use the CCR: <code>Bcc</code>, <code>DBcc</code>, <code>Scc</code>, and <code>TRAPcc</code>. The following table lists all the possible conditions we can test on the Motorola 68000 and their meaning</p>
<table>
<thead>
<tr>
<th>Instruction</th>
<th>Full name</th>
<th>Tested condition</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td>CC</td>
<td>Carry Clear</td>
<td>C == 0</td>
<td></td>
</tr>
<tr>
<td>CS</td>
<td>Carry Set</td>
<td>C == 1</td>
<td></td>
</tr>
<tr>
<td>EQ</td>
<td>EQual</td>
<td>Z == 1</td>
<td></td>
</tr>
<tr>
<td>F</td>
<td>False</td>
<td>Always false</td>
<td>Not available for Bcc</td>
</tr>
<tr>
<td>GE</td>
<td>Greater or Equal</td>
<td>N == V</td>
<td></td>
</tr>
<tr>
<td>GT</td>
<td>Greater Than</td>
<td>N == V and Z == 0</td>
<td></td>
</tr>
<tr>
<td>HI</td>
<td>HIgher than</td>
<td>C == 0 and Z == 0</td>
<td></td>
</tr>
<tr>
<td>LE</td>
<td>Less or Equal</td>
<td>Z == 1 or N != V</td>
<td></td>
</tr>
<tr>
<td>LS</td>
<td>Lower or Same</td>
<td>C == 1 or Z == 1</td>
<td></td>
</tr>
<tr>
<td>LT</td>
<td>Less Than</td>
<td>N != V</td>
<td></td>
</tr>
<tr>
<td>MI</td>
<td>MInus</td>
<td>N == 1</td>
<td></td>
</tr>
<tr>
<td>NE</td>
<td>Not Equal</td>
<td>Z == 0</td>
<td></td>
</tr>
<tr>
<td>PL</td>
<td>PLus</td>
<td>N == 0</td>
<td></td>
</tr>
<tr>
<td>T</td>
<td>True</td>
<td>Always true</td>
<td>Not available for Bcc</td>
</tr>
<tr>
<td>VC</td>
<td>V Clear</td>
<td>V == 0</td>
<td></td>
</tr>
<tr>
<td>VS</td>
<td>V Set</td>
<td>V == 1</td>
<td></td>
</tr>
</tbody>
</table>
<p>The reason why the <code>T</code> and <code>F</code> conditions are not available for <code>Bcc</code> instructions is simple: <code>bt</code> would mean "branch always", and the <code>bra</code> instruction does exactly this, while <code>bf</code> would mean "never branch" and it's arguably useless.</p>
<p>Let's see an example of use with a standard comparison instruction: <code>cmp</code></p>
<div class="highlight"><pre><span></span><code><span class="err">cmp.w   d0,d1</span>
<span class="err">beq.b   0x1522</span>
</code></pre></div>


<p>Here, the processor compares <code>d0</code> and <code>d1</code> computing the subtraction <code>d1 - d0</code> and setting the CCR flags according to the nature of the result. The processors manual (Programmer's Reference Manual, section 4-75, page 179) tells us that the flags are affected according to these rules</p>
<ul>
<li><code>X</code> — Not affected.</li>
<li><code>N</code> — Set if the result is negative; cleared otherwise.</li>
<li><code>Z</code> — Set if the result is zero; cleared otherwise.</li>
<li><code>V</code> — Set if an overflow occurs; cleared otherwise.</li>
<li><code>C</code> — Set if a borrow occurs; cleared otherwise.</li>
</ul>
<p>The <code>beq</code> instruction on the second line checks only the <code>Z</code> flag, however, so what we are checking here is if <code>d0</code> and <code>d1</code> have the same value.</p>
<p>A less straightforward example involves <code>move</code></p>
<div class="highlight"><pre><span></span><code><span class="err">move.w  0x1c(a1),d0</span>
<span class="err">beq.b   0x151e</span>
</code></pre></div>


<p>The first line moves the value at <code>a1 + 0x1c</code> into <code>d0</code>. The <code>move</code> instruction page (Programmer's Reference Manual, section 4-116, page 220) says that it affects only the <code>N</code> and <code>Z</code> flags</p>
<ul>
<li><code>X</code> — Not affected.</li>
<li><code>N</code> — Set if the result is negative; cleared otherwise.</li>
<li><code>Z</code> — Set if the result is zero; cleared otherwise.</li>
<li><code>V</code> — Always cleared.</li>
<li><code>C</code> — Always cleared.</li>
</ul>
<p>Here, the tested result is the value that has been moved. So, the next line branches only if the address <code>a1 + 0x1c</code> (and later <code>d0</code>) contains a zero.</p>
<p>Pay attention that <code>GE</code>, <code>GT</code>, <code>LE</code>, and <code>LT</code> read <code>N</code>, so they should be used only with signed integers Unsigned integers, instead, should be compared using <code>HI</code> and <code>LS</code>.</p>
<h1 id="enqueue"><code>Enqueue</code><a class="headerlink" href="#enqueue" title="Permanent link">&para;</a></h1>
<p>In the previous article we discussed the structure of a memory node created by <code>AddMemList</code> and I briefly mentioned <code>Enqueue</code> and a protected version of it. <code>Enqueue</code> is the function that Exec uses to add a node into a linked list, following a simple schema based on priorities, but it turns out <code>AddMemList</code> does not use it directly, resorting to a version of it wrapped by two other functions, namely <code>Forbid</code> and <code>Permit</code> that are connected to task rescheduling. For the time being, however, we may forget the wrappers and jump directly to <code>Enqueue</code> and learn how the Amiga operating system was managing linked lists.</p>
<p>If the list we are managing is a singly linked list, where each node points to the successor only, we are forced to find the node <em>after which</em> we want to insert the new one. This is mandatory, as we have to change its outgoing pointer, redirecting it to the new inserted node. In a doubly linked list such the ones used by the Amiga system this is not a problem, as from any point in the list we can start traversing it either forward or backward.</p>
<p>The following drawing is a simple representation of what happens in the Kickstart code when the <code>Enqueue</code> function is executed. <code>Ins</code> is the node we want to insert, <code>Pred</code> is the node after which we will insert <code>Ins</code>, and <code>Next</code> is the node before which we will insert <code>Ins</code>.</p>
<div class="highlight"><pre><span></span><code>                                  <span class="n">TAILPRED</span>  <span class="n">TAIL</span>
                                     <span class="o">|</span>       <span class="o">|</span>
                                     <span class="n">v</span>       <span class="n">v</span>
<span class="nl">BEFORE</span><span class="p">:</span>       <span class="n">HEAD</span> <span class="o">-&gt;</span> <span class="n">Node</span> <span class="o">-&gt;</span> <span class="n">Pred</span> <span class="o">-&gt;</span> <span class="n">Next</span> <span class="o">-&gt;</span> <span class="n">Node</span> <span class="o">-&gt;</span> <span class="mh">0x0</span>


                                         <span class="n">TAILPRED</span>  <span class="n">TAIL</span>
                                            <span class="o">|</span>       <span class="o">|</span>
                                            <span class="n">v</span>       <span class="n">v</span>
<span class="nl">AFTER</span><span class="p">:</span>        <span class="n">HEAD</span> <span class="o">-&gt;</span> <span class="n">Node</span> <span class="o">-&gt;</span> <span class="n">Pred</span>           <span class="n">Next</span> <span class="o">-&gt;</span> <span class="n">Node</span> <span class="o">-&gt;</span> <span class="mh">0x0</span>
                                  <span class="o">|</span>         <span class="o">^</span>
                                  <span class="o">|</span>         <span class="o">|</span>
                                  <span class="o">+-&gt;</span> <span class="n">Ins</span> <span class="o">--+</span>
</code></pre></div>


<p>As you can see there are several pointers that need to be changed. Both the <code>LN_SUCC</code> of <code>Pred</code> and <code>Ins</code>, but also the <code>LN_PRED</code> of <code>Next</code> and <code>Ins</code>.</p>
<p><code>Enqueue</code> has a very simple prototype</p>
<div class="highlight"><pre><span></span><code>Enqueue(list, node)
        aO    a1
</code></pre></div>


<p>where <code>a0</code> and <code>a1</code> are pointers respectively to the list header and to the node we are going to insert. It is worth recalling how the list header status is at the time when the first insertion happens, that is when either the chip or expansion memory are added to the system memory pool, managed through <code>MemList</code>. The latter is a list header <code>LH</code> structure and the actual values are the following</p>
<div class="highlight"><pre><span></span><code>    <span class="mh">0xe</span> <span class="o">+-------+</span> <span class="mh">0x150</span>
        <span class="o">|</span>       <span class="o">|</span>
    <span class="mh">0xd</span> <span class="o">+-------+</span> <span class="mh">0x14f</span> <span class="p">(</span><span class="n">LH_pad</span><span class="p">)</span>
        <span class="o">|</span> <span class="mh">0xa</span>   <span class="o">|</span>
    <span class="mh">0xc</span> <span class="o">+-------+</span> <span class="mh">0x14e</span> <span class="p">(</span><span class="n">LH_TYPE</span><span class="p">)</span>
        <span class="o">|</span> <span class="mh">0x142</span> <span class="o">|</span>
    <span class="mh">0x8</span> <span class="o">+-------+</span> <span class="mh">0x14a</span> <span class="p">(</span><span class="n">LH_TAILPRED</span><span class="p">)</span>
        <span class="o">|</span> <span class="mh">0x0</span>   <span class="o">|</span>
    <span class="mh">0x4</span> <span class="o">+-------+</span> <span class="mh">0x146</span> <span class="p">(</span><span class="n">LH_TAIL</span><span class="p">)</span>
        <span class="o">|</span> <span class="mh">0x146</span> <span class="o">|</span>
    <span class="mh">0x0</span> <span class="o">+-------+</span> <span class="mh">0x142</span> <span class="p">(</span><span class="n">LH_HEAD</span><span class="p">)</span>
</code></pre></div>


<p>With this structure in mind, let's dive into the source code of <code>Enqueue</code>. The function is defined at <code>0xfc1670</code></p>
<div class="highlight"><pre><span></span><code><span class="mi">00001670</span><span class="o">:</span> <span class="mi">1229</span> <span class="mi">0009</span>                 <span class="n">move</span><span class="o">.</span><span class="na">b</span>  <span class="mh">0x9</span><span class="o">(</span><span class="n">a1</span><span class="o">),</span><span class="n">d1</span>
<span class="mi">00001674</span><span class="o">:</span> <span class="mi">2010</span>                      <span class="n">move</span><span class="o">.</span><span class="na">l</span>  <span class="o">(</span><span class="n">a0</span><span class="o">),</span><span class="n">d0</span>
<span class="mi">00001676</span><span class="o">:</span> <span class="mi">2040</span>                      <span class="n">movea</span><span class="o">.</span><span class="na">l</span> <span class="n">d0</span><span class="o">,</span><span class="n">a0</span>
<span class="mi">00001678</span><span class="o">:</span> <span class="mi">2010</span>                      <span class="n">move</span><span class="o">.</span><span class="na">l</span>  <span class="o">(</span><span class="n">a0</span><span class="o">),</span><span class="n">d0</span>
<span class="mi">0000167</span><span class="n">a</span><span class="o">:</span> <span class="mi">6706</span>                      <span class="n">beq</span><span class="o">.</span><span class="na">b</span>   <span class="mh">0x1682</span>
<span class="mi">0000167</span><span class="n">c</span><span class="o">:</span> <span class="n">b228</span> <span class="mi">0009</span>                 <span class="n">cmp</span><span class="o">.</span><span class="na">b</span>   <span class="mh">0x9</span><span class="o">(</span><span class="n">a0</span><span class="o">),</span><span class="n">d1</span>
<span class="mi">00001680</span><span class="o">:</span> <span class="mi">6</span><span class="n">ff4</span>                      <span class="n">ble</span><span class="o">.</span><span class="na">b</span>   <span class="mh">0x1676</span>
<span class="mi">00001682</span><span class="o">:</span> <span class="mi">2028</span> <span class="mi">0004</span>                 <span class="n">move</span><span class="o">.</span><span class="na">l</span>  <span class="mh">0x4</span><span class="o">(</span><span class="n">a0</span><span class="o">),</span><span class="n">d0</span>
<span class="mi">00001686</span><span class="o">:</span> <span class="mi">2149</span> <span class="mi">0004</span>                 <span class="n">move</span><span class="o">.</span><span class="na">l</span>  <span class="n">a1</span><span class="o">,</span><span class="mh">0x4</span><span class="o">(</span><span class="n">a0</span><span class="o">)</span>
<span class="mi">0000168</span><span class="n">a</span><span class="o">:</span> <span class="mi">2288</span>                      <span class="n">move</span><span class="o">.</span><span class="na">l</span>  <span class="n">a0</span><span class="o">,(</span><span class="n">a1</span><span class="o">)</span>
<span class="mi">0000168</span><span class="n">c</span><span class="o">:</span> <span class="mi">2340</span> <span class="mi">0004</span>                 <span class="n">move</span><span class="o">.</span><span class="na">l</span>  <span class="n">d0</span><span class="o">,</span><span class="mh">0x4</span><span class="o">(</span><span class="n">a1</span><span class="o">)</span>
<span class="mi">00001690</span><span class="o">:</span> <span class="mi">2040</span>                      <span class="n">movea</span><span class="o">.</span><span class="na">l</span> <span class="n">d0</span><span class="o">,</span><span class="n">a0</span>
<span class="mi">00001692</span><span class="o">:</span> <span class="mi">2089</span>                      <span class="n">move</span><span class="o">.</span><span class="na">l</span>  <span class="n">a1</span><span class="o">,(</span><span class="n">a0</span><span class="o">)</span>
<span class="mi">00001694</span><span class="o">:</span> <span class="mi">4</span><span class="n">e75</span>                      <span class="n">rts</span>     
</code></pre></div>


<p>And it can be roughly divided into three sections, according to the internal jumps.</p>
<div class="highlight"><pre><span></span><code><span class="n">Init</span><span class="o">:</span>
<span class="mi">00001670</span><span class="o">:</span> <span class="mi">1229</span> <span class="mi">0009</span>                 <span class="n">move</span><span class="o">.</span><span class="na">b</span>  <span class="mh">0x9</span><span class="o">(</span><span class="n">a1</span><span class="o">),</span><span class="n">d1</span>
<span class="mi">00001674</span><span class="o">:</span> <span class="mi">2010</span>                      <span class="n">move</span><span class="o">.</span><span class="na">l</span>  <span class="o">(</span><span class="n">a0</span><span class="o">),</span><span class="n">d0</span>

<span class="n">FindPos</span><span class="o">:</span>
<span class="mi">00001676</span><span class="o">:</span> <span class="mi">2040</span>                      <span class="n">movea</span><span class="o">.</span><span class="na">l</span> <span class="n">d0</span><span class="o">,</span><span class="n">a0</span>
<span class="mi">00001678</span><span class="o">:</span> <span class="mi">2010</span>                      <span class="n">move</span><span class="o">.</span><span class="na">l</span>  <span class="o">(</span><span class="n">a0</span><span class="o">),</span><span class="n">d0</span>
<span class="mi">0000167</span><span class="n">a</span><span class="o">:</span> <span class="mi">6706</span>                      <span class="n">beq</span><span class="o">.</span><span class="na">b</span>   <span class="n">InsertNode</span>
<span class="mi">0000167</span><span class="n">c</span><span class="o">:</span> <span class="n">b228</span> <span class="mi">0009</span>                 <span class="n">cmp</span><span class="o">.</span><span class="na">b</span>   <span class="mh">0x9</span><span class="o">(</span><span class="n">a0</span><span class="o">),</span><span class="n">d1</span>
<span class="mi">00001680</span><span class="o">:</span> <span class="mi">6</span><span class="n">ff4</span>                      <span class="n">ble</span><span class="o">.</span><span class="na">b</span>   <span class="n">FindPos</span>

<span class="n">InsertNode</span><span class="o">:</span>
<span class="mi">00001682</span><span class="o">:</span> <span class="mi">2028</span> <span class="mi">0004</span>                 <span class="n">move</span><span class="o">.</span><span class="na">l</span>  <span class="mh">0x4</span><span class="o">(</span><span class="n">a0</span><span class="o">),</span><span class="n">d0</span>
<span class="mi">00001686</span><span class="o">:</span> <span class="mi">2149</span> <span class="mi">0004</span>                 <span class="n">move</span><span class="o">.</span><span class="na">l</span>  <span class="n">a1</span><span class="o">,</span><span class="mh">0x4</span><span class="o">(</span><span class="n">a0</span><span class="o">)</span>
<span class="mi">0000168</span><span class="n">a</span><span class="o">:</span> <span class="mi">2288</span>                      <span class="n">move</span><span class="o">.</span><span class="na">l</span>  <span class="n">a0</span><span class="o">,(</span><span class="n">a1</span><span class="o">)</span>
<span class="mi">0000168</span><span class="n">c</span><span class="o">:</span> <span class="mi">2340</span> <span class="mi">0004</span>                 <span class="n">move</span><span class="o">.</span><span class="na">l</span>  <span class="n">d0</span><span class="o">,</span><span class="mh">0x4</span><span class="o">(</span><span class="n">a1</span><span class="o">)</span>
<span class="mi">00001690</span><span class="o">:</span> <span class="mi">2040</span>                      <span class="n">movea</span><span class="o">.</span><span class="na">l</span> <span class="n">d0</span><span class="o">,</span><span class="n">a0</span>
<span class="mi">00001692</span><span class="o">:</span> <span class="mi">2089</span>                      <span class="n">move</span><span class="o">.</span><span class="na">l</span>  <span class="n">a1</span><span class="o">,(</span><span class="n">a0</span><span class="o">)</span>
<span class="mi">00001694</span><span class="o">:</span> <span class="mi">4</span><span class="n">e75</span>                      <span class="n">rts</span>     
</code></pre></div>


<p>The first section, <code>Init</code>, prepares the execution of the rest of the function. The rest bla</p>
<p>As I did for other functions in the previous articles, I'm going to dissect this line by line. Let's start from the <code>Init</code> part.</p>
<h2 id="init">Init<a class="headerlink" href="#init" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><span class="n">Init</span><span class="o">:</span>
<span class="mi">00001670</span><span class="o">:</span> <span class="mi">1229</span> <span class="mi">0009</span>                 <span class="n">move</span><span class="o">.</span><span class="na">b</span>  <span class="mh">0x9</span><span class="o">(</span><span class="n">a1</span><span class="o">),</span><span class="n">d1</span>
<span class="mi">00001674</span><span class="o">:</span> <span class="mi">2010</span>                      <span class="n">move</span><span class="o">.</span><span class="na">l</span>  <span class="o">(</span><span class="n">a0</span><span class="o">),</span><span class="n">d0</span>
</code></pre></div>


<p>Since <code>a1</code> points to the node to be inserted, <code>0x9(a1)</code> is the <code>LN_PRI</code> field of that node, that is the priority. The first line thus stores it in <code>d1</code> because it will be used to search for the insertion point, as the list is maintained in priority order.</p>
<p>The second line is the core or the node traversal algorithm. Since <code>a0</code> points to a <code>LH</code> structure, it is also the address of the first field <code>LH_HEAD</code>. <code>(a0)</code>, thus, is the dereferencing of that address, which means the address of the first node in the list. Given the figures I showed before for <code>MemList</code>, <code>a0</code> is <code>0x142</code> so a <code>move a0,d0</code> would store <code>0x142</code> (the value of <code>a0</code>) in <code>d0</code>. <code>(a0)</code>, instead, is the content of that address in memory, namely <code>0x146</code>, so <code>move (a0),d0</code> stores <code>0x146</code> (the content of <code>0x142</code>) in <code>d0</code>.</p>
<p>Putting aside the intricacies of the addressing modes, the second line stores the address of the first node in the list, which is the part of the header that starts with <code>LH_TAIL</code>. The header thus acts as the first node of the list.</p>
<h2 id="findpos">FindPos<a class="headerlink" href="#findpos" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><span class="n">FindPos</span><span class="o">:</span>
<span class="mi">00001676</span><span class="o">:</span> <span class="mi">2040</span>                      <span class="n">movea</span><span class="o">.</span><span class="na">l</span> <span class="n">d0</span><span class="o">,</span><span class="n">a0</span>
<span class="mi">00001678</span><span class="o">:</span> <span class="mi">2010</span>                      <span class="n">move</span><span class="o">.</span><span class="na">l</span>  <span class="o">(</span><span class="n">a0</span><span class="o">),</span><span class="n">d0</span>
<span class="mi">0000167</span><span class="n">a</span><span class="o">:</span> <span class="mi">6706</span>                      <span class="n">beq</span><span class="o">.</span><span class="na">b</span>   <span class="n">InsertNode</span>
<span class="mi">0000167</span><span class="n">c</span><span class="o">:</span> <span class="n">b228</span> <span class="mi">0009</span>                 <span class="n">cmp</span><span class="o">.</span><span class="na">b</span>   <span class="mh">0x9</span><span class="o">(</span><span class="n">a0</span><span class="o">),</span><span class="n">d1</span>
<span class="mi">00001680</span><span class="o">:</span> <span class="mi">6</span><span class="n">ff4</span>                      <span class="n">ble</span><span class="o">.</span><span class="na">b</span>   <span class="n">FindPos</span>
</code></pre></div>


<p>The first two lines repeat the same algorithm. The address of the current node (<code>d0</code>) is moved to <code>a0</code> and the dereferencing operation <code>(a0)</code> puts in <code>d0</code> the address of the following node. The reason why we do it in two lines is that the Address Register Indirect Mode can be used only with <code>An</code> registers. At this point <code>d0</code> contains the address of the second node, the successor of the header.</p>
<p>If the list contains at least one node, <code>d0</code> contains its address. But if the list is empty at this point <code>d0</code> contains <code>0x0</code>, and this is the condition tested by the <code>beq.b</code> instruction. If <code>d0</code> is empty we reached the end of the list, which means that there was no better place to insert the node, and we jump to the actual node insertion code, <code>InsertNode</code>. If the value is not zero, the current node has a proper successor, so let's check it's priority to see if we need to go on or if we can stop here. The code compares the priorities of the current node and of the <code>Ins</code> node, and if the latter is less than the former we can loop back to <code>FindPos</code> and move to the next node. Remember that priorities are expressed with negative numbers only, so "less than" actually means "higher priority".</p>
<h2 id="insertnode">InsertNode<a class="headerlink" href="#insertnode" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><span class="n">InsertNode</span><span class="o">:</span>
<span class="mi">00001682</span><span class="o">:</span> <span class="mi">2028</span> <span class="mi">0004</span>                 <span class="n">move</span><span class="o">.</span><span class="na">l</span>  <span class="mh">0x4</span><span class="o">(</span><span class="n">a0</span><span class="o">),</span><span class="n">d0</span>
<span class="mi">00001686</span><span class="o">:</span> <span class="mi">2149</span> <span class="mi">0004</span>                 <span class="n">move</span><span class="o">.</span><span class="na">l</span>  <span class="n">a1</span><span class="o">,</span><span class="mh">0x4</span><span class="o">(</span><span class="n">a0</span><span class="o">)</span>
<span class="mi">0000168</span><span class="n">a</span><span class="o">:</span> <span class="mi">2288</span>                      <span class="n">move</span><span class="o">.</span><span class="na">l</span>  <span class="n">a0</span><span class="o">,(</span><span class="n">a1</span><span class="o">)</span>
<span class="mi">0000168</span><span class="n">c</span><span class="o">:</span> <span class="mi">2340</span> <span class="mi">0004</span>                 <span class="n">move</span><span class="o">.</span><span class="na">l</span>  <span class="n">d0</span><span class="o">,</span><span class="mh">0x4</span><span class="o">(</span><span class="n">a1</span><span class="o">)</span>
<span class="mi">00001690</span><span class="o">:</span> <span class="mi">2040</span>                      <span class="n">movea</span><span class="o">.</span><span class="na">l</span> <span class="n">d0</span><span class="o">,</span><span class="n">a0</span>
<span class="mi">00001692</span><span class="o">:</span> <span class="mi">2089</span>                      <span class="n">move</span><span class="o">.</span><span class="na">l</span>  <span class="n">a1</span><span class="o">,(</span><span class="n">a0</span><span class="o">)</span>
<span class="mi">00001694</span><span class="o">:</span> <span class="mi">4</span><span class="n">e75</span>                      <span class="n">rts</span>     
</code></pre></div>


<p>In either case, when we reach the tail or when the priority of the next node is lower than the one of the new node, we reach <code>InsertNode</code>. At this point <code>a0</code> points to <code>Next</code> and we can access <code>Pred</code> through <code>0x4(a0)</code> (that is <code>LN_SUCC</code> of <code>Next</code>).</p>
<div class="highlight"><pre><span></span><code><span class="mi">00001682</span><span class="o">:</span> <span class="mi">2028</span> <span class="mi">0004</span>                 <span class="n">move</span><span class="o">.</span><span class="na">l</span>  <span class="mh">0x4</span><span class="o">(</span><span class="n">a0</span><span class="o">),</span><span class="n">d0</span>
<span class="mi">00001686</span><span class="o">:</span> <span class="mi">2149</span> <span class="mi">0004</span>                 <span class="n">move</span><span class="o">.</span><span class="na">l</span>  <span class="n">a1</span><span class="o">,</span><span class="mh">0x4</span><span class="o">(</span><span class="n">a0</span><span class="o">)</span>
</code></pre></div>


<p>This first stores the aforementioned address of <code>Pred</code> in <code>d0</code>, then replaces it with the value of <code>a1</code>. The result is that the predecessor of <code>Next</code> becomes <code>Ins</code>.</p>
<div class="highlight"><pre><span></span><code><span class="mi">0000168</span><span class="n">a</span><span class="o">:</span> <span class="mi">2288</span>                      <span class="n">move</span><span class="o">.</span><span class="na">l</span>  <span class="n">a0</span><span class="o">,(</span><span class="n">a1</span><span class="o">)</span>
<span class="mi">0000168</span><span class="n">c</span><span class="o">:</span> <span class="mi">2340</span> <span class="mi">0004</span>                 <span class="n">move</span><span class="o">.</span><span class="na">l</span>  <span class="n">d0</span><span class="o">,</span><span class="mh">0x4</span><span class="o">(</span><span class="n">a1</span><span class="o">)</span>
</code></pre></div>


<p>This moves <code>a0</code>, the address of <code>Next</code>, into the first field of <code>Ins</code>, that is <code>Next</code> becomes the successor of <code>Ins</code>. The second line moves <code>d0</code> (the address of <code>Pred</code>) into the <code>LN_PRED</code> of <code>Ins</code>.</p>
<div class="highlight"><pre><span></span><code><span class="mi">00001690</span><span class="o">:</span> <span class="mi">2040</span>                      <span class="n">movea</span><span class="o">.</span><span class="na">l</span> <span class="n">d0</span><span class="o">,</span><span class="n">a0</span>
<span class="mi">00001692</span><span class="o">:</span> <span class="mi">2089</span>                      <span class="n">move</span><span class="o">.</span><span class="na">l</span>  <span class="n">a1</span><span class="o">,(</span><span class="n">a0</span><span class="o">)</span>
<span class="mi">00001694</span><span class="o">:</span> <span class="mi">4</span><span class="n">e75</span>                      <span class="n">rts</span>     
</code></pre></div>


<p>Last, the address of <code>Ins</code> becomes the <code>LN_SUCC</code> of <code>Pred</code>, so we move <code>d0</code> into <code>a0</code> because, as I already mentioned, the Address Register Indirect Mode can be used only with <code>An</code> registers. After this the function returns to the caller.</p>
<h1 id="remove"><code>Remove</code><a class="headerlink" href="#remove" title="Permanent link">&para;</a></h1>
<p>Since we reviewed the code of <code>Enqueue</code> it makes sense to have a look at the opposite function, <code>Remove</code>. A protected version of this exists as well, but here I will just show the code of the pure function without the wrapper.</p>
<p>Removing a node is simpler than adding it, as all we have to do is to make <code>Pred</code> point to <code>Next</code> and vice versa, so the function is much shorter. It's worth noting that while the function accepts the address of the node in <code>a1</code> the value in this register is eventually overwritten, so the address has to be kept elsewhere when the function is called.</p>
<div class="highlight"><pre><span></span><code><span class="mi">0000163</span><span class="n">c</span><span class="o">:</span> <span class="mi">2051</span>                      <span class="n">movea</span><span class="o">.</span><span class="na">l</span> <span class="o">(</span><span class="n">a1</span><span class="o">),</span><span class="n">a0</span>
<span class="mi">0000163</span><span class="n">e</span><span class="o">:</span> <span class="mi">2269</span> <span class="mi">0004</span>                 <span class="n">movea</span><span class="o">.</span><span class="na">l</span> <span class="mh">0x4</span><span class="o">(</span><span class="n">a1</span><span class="o">),</span><span class="n">a1</span>
<span class="mi">00001642</span><span class="o">:</span> <span class="mi">2288</span>                      <span class="n">move</span><span class="o">.</span><span class="na">l</span>  <span class="n">a0</span><span class="o">,(</span><span class="n">a1</span><span class="o">)</span>
<span class="mi">00001644</span><span class="o">:</span> <span class="mi">2149</span> <span class="mi">0004</span>                 <span class="n">move</span><span class="o">.</span><span class="na">l</span>  <span class="n">a1</span><span class="o">,</span><span class="mh">0x4</span><span class="o">(</span><span class="n">a0</span><span class="o">)</span>
<span class="mi">00001648</span><span class="o">:</span> <span class="mi">4</span><span class="n">e75</span> 
</code></pre></div>


<p>The first two lines store the address of <code>Next</code> in <code>a0</code> and of <code>Pred</code> in <code>a1</code> (overwriting the input value). The third line makes <code>Next</code> the successor of <code>Pred</code> and the fourth line makes <code>Pred</code> the predecessor of <code>Next</code>. Then the function returns to the caller.</p>
<h1 id="addlibrary"><code>AddLibrary</code><a class="headerlink" href="#addlibrary" title="Permanent link">&para;</a></h1>
<p>In the <a href="https://www.thedigitalcatonline.com/blog/2018/06/25/exploring-the-amiga-6/">6th post</a> of this series we left Kickstart just after it finished adding the physical memory to the system pool. The last instruction we mentioned was a call to <code>AddLibrary</code>, and this is then the next function I will explore.</p>
<p>The code of the function is at <code>fc1448</code>, and required some work before I was able to read it (see the section "Manual decompilation").</p>
<div class="highlight"><pre><span></span><code><span class="mi">00001448</span><span class="o">:</span> <span class="mi">41</span><span class="n">ee</span> <span class="mi">017</span><span class="n">a</span>                 <span class="n">lea</span> <span class="mh">0x17a</span><span class="o">(</span><span class="n">a6</span><span class="o">),</span><span class="n">a0</span>
<span class="mi">0000144</span><span class="n">c</span><span class="o">:</span> <span class="mi">6100</span> <span class="mi">0270</span>                 <span class="n">bsr</span><span class="o">.</span><span class="na">w</span> <span class="mh">0x16be</span>
<span class="mi">00001450</span><span class="o">:</span> <span class="mi">6100</span> <span class="mi">0082</span>                 <span class="n">bsr</span><span class="o">.</span><span class="na">w</span> <span class="mh">0x14d4</span>
<span class="mi">00001454</span><span class="o">:</span> <span class="mi">4</span><span class="n">e75</span>                      <span class="n">rts</span>     
</code></pre></div>


<p>The first line loads the absolute address of an object <code>0x17a</code> bytes after the ExecBase address, and looking up this displacement in the library structure published in both the fifth and sixth instalment we find, rather unsurprisingly, that this is the address of <code>LibList</code>.</p>
<p>The following lines call the protected version of <code>Enqueue</code> and <code>SumLibrary</code>, after which the routine returns to the caller. The call to <code>Enqueue</code> follows what I explained at the beginning of this post, where this time <code>a0</code> points to the library system list and <code>a1</code> points to the base address of Exec, set just before the call to <code>AddLibrary</code>. So the Exec library itself is added to the system libraries through this routine.</p>
<p><code>SumLibrary</code>, as the name suggests, computes the checksum of a library, or checks the existing one.</p>
<h1 id="manual-decompilation">Manual decompilation<a class="headerlink" href="#manual-decompilation" title="Permanent link">&para;</a></h1>
<p>When I was following the call to <code>AddLibrary</code> from the main body of Kickstart I was surprised to find this code</p>
<div class="highlight"><pre><span></span><code><span class="mi">00001446</span><span class="o">:</span> <span class="mi">0000</span> <span class="mi">41</span><span class="n">ee</span>                 <span class="n">ori</span><span class="o">.</span><span class="na">b</span>   <span class="err">#</span><span class="o">-</span><span class="mh">0x12</span><span class="o">,</span><span class="n">d0</span>
<span class="mi">0000144</span><span class="n">a</span><span class="o">:</span> <span class="mi">017</span><span class="n">a</span> <span class="mi">6100</span>                 <span class="n">bchg</span>    <span class="n">d0</span><span class="o">,</span><span class="mh">0x754c</span><span class="o">(</span><span class="n">pc</span><span class="o">)</span>
<span class="mi">0000144</span><span class="n">e</span><span class="o">:</span> <span class="mi">0270</span> <span class="mi">6100</span> <span class="mi">0082</span>            <span class="n">andi</span><span class="o">.</span><span class="na">w</span>  <span class="err">#</span><span class="mh">0x6100</span><span class="o">,(-</span><span class="mh">0x7e</span><span class="o">,</span><span class="n">a0</span><span class="o">,</span><span class="n">d0</span><span class="o">.</span><span class="na">w</span><span class="o">)</span>
<span class="mi">00001454</span><span class="o">:</span> <span class="mi">4</span><span class="n">e75</span>                      <span class="n">rts</span>     
</code></pre></div>


<p>which at first glance doesn't look like a basic function, as the instructions are too convoluted. Furthermore, the branch uses the address <code>0x1448</code>, which is thus supposed to be the beginning of the function. A quick look at the hexadecimal values reveals the truth: at <code>0x1446</code> Kickstart contains a padding word <code>0000</code> that confused the decompiler. To see the code of the function I had to manually decompile the machine code, and since the process is very interesting I decided to show it in detail here.</p>
<p>When you try to manually decompile some machine code you need a cheat sheet and the processor manual (see the resources section), which can help you to quickly track down the meaning of the single bits. The values we are interested in are</p>
<div class="highlight"><pre><span></span><code><span class="mi">00001448</span><span class="o">:</span> <span class="mi">41</span><span class="n">ee</span>
<span class="mi">0000144</span><span class="n">a</span><span class="o">:</span> <span class="mi">017</span><span class="n">a</span>
<span class="mi">0000144</span><span class="n">c</span><span class="o">:</span> <span class="mi">6100</span>
<span class="mi">0000144</span><span class="n">e</span><span class="o">:</span> <span class="mi">0270</span>
<span class="mi">00001450</span><span class="o">:</span> <span class="mi">6100</span>
<span class="mi">00001452</span><span class="o">:</span> <span class="mi">0082</span>
<span class="mi">00001454</span><span class="o">:</span> <span class="mi">4</span><span class="n">e75</span>
</code></pre></div>


<p>since <code>fc1456</code> is listed as the address of the <code>RemLibrary</code> function. THe binary representation of these values is</p>
<div class="highlight"><pre><span></span><code><span class="mi">00001448</span><span class="o">:</span> <span class="mi">0100</span> <span class="mi">0001</span> <span class="mi">1110</span> <span class="mi">1110</span>
<span class="mi">0000144</span><span class="n">a</span><span class="o">:</span> <span class="mi">0000</span> <span class="mi">0001</span> <span class="mi">0111</span> <span class="mi">1010</span>
<span class="mi">0000144</span><span class="n">c</span><span class="o">:</span> <span class="mi">0110</span> <span class="mi">0001</span> <span class="mi">0000</span> <span class="mi">0000</span>
<span class="mi">0000144</span><span class="n">e</span><span class="o">:</span> <span class="mi">0000</span> <span class="mi">0010</span> <span class="mi">0111</span> <span class="mi">0000</span>
<span class="mi">00001450</span><span class="o">:</span> <span class="mi">0110</span> <span class="mi">0001</span> <span class="mi">0000</span> <span class="mi">0000</span>
<span class="mi">00001452</span><span class="o">:</span> <span class="mi">0000</span> <span class="mi">0000</span> <span class="mi">1000</span> <span class="mi">0010</span>
<span class="mi">00001454</span><span class="o">:</span> <span class="mi">0100</span> <span class="mi">1110</span> <span class="mi">0111</span> <span class="mi">0101</span>
</code></pre></div>


<p>Now, the first 4 bits of any Motorola 68k instruction are the instruction code. While multiple instructions share the same 4 bits (for example <code>andi</code> and <code>subi</code>), those bits are never used for addressing or to specify modes, so they are a good starting point.</p>
<p>The instruction at <code>0x1448</code> starts with <code>0100</code> followed by a <code>0</code>, and this narrows the selection to either <code>lea</code> or <code>chk</code>. Both instructions use the following 3 bits to specify a register (<code>An</code> for <code>lea</code>, <code>Dn</code> for <code>chk</code>), but then the first has a fixed group <code>111</code>, while the second has a group <code>110</code>. This means that we are looking at a <code>lea</code>. The three bits I mentioned are <code>000</code>, which translates in <code>a0</code> as a target. The last 6 bits are the addressing mode and the register, and the cheat sheet tells us that <code>101 110</code> corresponds to Address Register Indirect with Displacement Mode on <code>a6</code>. <code>101</code> is labelled as <code>(d16, An)</code>, while <code>110</code> is the number 6. The following word is thus the <code>d16</code> displacement from <code>a6</code>, which means that <code>41ee 017a</code> translates to <code>lea 0x17a(a6),a0</code>.</p>
<p>The second instruction starts at <code>0x144c</code> with <code>0110</code>, which is the signature of all the branch commands: <code>bra</code>, <code>bsr</code>, and all the condition-based ones like <code>bgt</code>, <code>blt</code>, and so on. Since the following 4 bits are <code>0001</code> we know this is a <code>bsr</code>, branch to subroutine. Now, in this instruction the 8 least significant bits tell us what the displacement is, and thus the type of the operand (Programmer's Manual, section 4-59, page 163). In this case they are all <code>0</code>, which means a word displacement, which is in the next 16 bits. Pay attention that, as we discussed for <code>lea</code> in the <a href="https://www.thedigitalcatonline.com/blog/2018/05/28/exploring-the-amiga-1/">first post</a> the Program Counter contains the address of the first displacement word. In this case the displacement is <code>0x270</code> at address <code>0x144e</code>, so the branch address is the sum of the two, that is <code>0x16be</code>.</p>
<p>The third instruction is again a <code>bsr</code> and following the same process we find out that the branch address is the sum between <code>0x82</code> and <code>0x1452</code>, that is <code>0x14d4</code>. The final instruction is an <code>rts</code>, as we expected, and as the decompiler correctly told us.</p>
<p>The most important thing to keep in mind when manually reading instructions is the position of the Program Counter. As we already saw two times, with <code>lea</code> and with <code>bsr</code>, the PC moves as soon as the 16-bit instruction has been read, which means that when a displacement is given we have to use the address of the displacement itself as a base for our calculations.</p>
<h1 id="resources">Resources<a class="headerlink" href="#resources" title="Permanent link">&para;</a></h1>
<ul>
<li>Motorola M68000 Family Programmer's Reference Manual <a href="https://www.nxp.com/docs/en/reference-manual/M68000PRM.pdf">PDF here</a></li>
<li>Motorola 68000 Opcodes Cheat Sheet http://goldencrystal.free.fr/M68kOpcodes-v2.3.pdf</li>
</ul>
<h1 id="feedback">Feedback<a class="headerlink" href="#feedback" title="Permanent link">&para;</a></h1>
<p>Feel free to reach me on <a href="https://twitter.com/thedigicat">Twitter</a> if you have questions. The <a href="https://github.com/TheDigitalCatOnline/thedigitalcatonline.github.com/issues">GitHub issues</a> page is the best place to submit corrections.</p>
  </section>

  <section class="footer">
    <h1>Part 8 of the Exploring the Amiga series</h1>
    <div class="box">
      <h5>Previous articles</h5>
      <ul>
        <li><a href="/blog/2018/05/28/exploring-the-amiga-1/">Exploring the Amiga - Part 1</a></li>
        <li><a href="/blog/2018/05/28/exploring-the-amiga-2/">Exploring the Amiga - Part 2</a></li>
        <li><a href="/blog/2018/06/08/exploring-the-amiga-3/">Exploring the Amiga - Part 3</a></li>
        <li><a href="/blog/2018/06/14/exploring-the-amiga-4/">Exploring the Amiga - Part 4</a></li>
        <li><a href="/blog/2018/06/25/exploring-the-amiga-5/">Exploring the Amiga - Part 5</a></li>
        <li><a href="/blog/2018/06/25/exploring-the-amiga-6/">Exploring the Amiga - Part 6</a></li>
        <li><a href="/blog/2019/02/19/exploring-the-amiga-7/">Exploring the Amiga - Part 7</a></li>
      </ul>
      
    </div>
  </section>

  <section class="footer">
    <h1>Related Posts</h1>
    <div class="posts mini">
      <article class="card">
        <a href="/blog/2019/02/19/exploring-the-amiga-7/" class="image">
          <img src="/images/exploring-the-amiga-7.jpg" alt="exploring-the-amiga-7" />
        </a>
        <div class="card-body">
          <a href="/blog/2019/02/19/exploring-the-amiga-7/"><h2 class="card-title">Exploring the Amiga - Part 7</h2></a>
	  <p class="article-info">
            <time datetime="2019-02-19T13:00:00+01:00">Feb 19, 2019</time>
            <span class="fas fa-tags"></span>
            <a href="/categories/assembly/" class="tag">assembly</a>            <a href="/categories/amiga/" class="tag">amiga</a>            <a href="/categories/retroprogramming/" class="tag">retroprogramming</a>          </p>
        </div>
      </article>
      <article class="card">
        <a href="/blog/2018/06/25/exploring-the-amiga-6/" class="image">
          <img src="/images/exploring-the-amiga-6.jpg" alt="exploring-the-amiga-6" />
        </a>
        <div class="card-body">
          <a href="/blog/2018/06/25/exploring-the-amiga-6/"><h2 class="card-title">Exploring the Amiga - Part 6</h2></a>
	  <p class="article-info">
            <time datetime="2018-06-25T13:00:00+01:00">Jun 25, 2018</time>
            <span class="fas fa-tags"></span>
            <a href="/categories/assembly/" class="tag">assembly</a>            <a href="/categories/amiga/" class="tag">amiga</a>            <a href="/categories/retroprogramming/" class="tag">retroprogramming</a>          </p>
        </div>
      </article>
      <article class="card">
        <a href="/blog/2018/06/25/exploring-the-amiga-5/" class="image">
          <img src="/images/exploring-the-amiga-5.jpg" alt="exploring-the-amiga-5" />
        </a>
        <div class="card-body">
          <a href="/blog/2018/06/25/exploring-the-amiga-5/"><h2 class="card-title">Exploring the Amiga - Part 5</h2></a>
	  <p class="article-info">
            <time datetime="2018-06-25T12:00:00+01:00">Jun 25, 2018</time>
            <span class="fas fa-tags"></span>
            <a href="/categories/assembly/" class="tag">assembly</a>            <a href="/categories/amiga/" class="tag">amiga</a>            <a href="/categories/retroprogramming/" class="tag">retroprogramming</a>          </p>
        </div>
      </article>
      <article class="card">
        <a href="/blog/2018/06/14/exploring-the-amiga-4/" class="image">
          <img src="/images/exploring-the-amiga-4.jpg" alt="exploring-the-amiga-4" />
        </a>
        <div class="card-body">
          <a href="/blog/2018/06/14/exploring-the-amiga-4/"><h2 class="card-title">Exploring the Amiga - Part 4</h2></a>
	  <p class="article-info">
            <time datetime="2018-06-14T14:30:00+01:00">Jun 14, 2018</time>
            <span class="fas fa-tags"></span>
            <a href="/categories/assembly/" class="tag">assembly</a>            <a href="/categories/amiga/" class="tag">amiga</a>            <a href="/categories/retroprogramming/" class="tag">retroprogramming</a>          </p>
        </div>
      </article>
      <article class="card">
        <a href="/blog/2018/06/08/exploring-the-amiga-3/" class="image">
          <img src="/images/exploring-the-amiga-3.jpg" alt="exploring-the-amiga-3" />
        </a>
        <div class="card-body">
          <a href="/blog/2018/06/08/exploring-the-amiga-3/"><h2 class="card-title">Exploring the Amiga - Part 3</h2></a>
	  <p class="article-info">
            <time datetime="2018-06-08T12:30:00+01:00">Jun 8, 2018</time>
            <span class="fas fa-tags"></span>
            <a href="/categories/assembly/" class="tag">assembly</a>            <a href="/categories/amiga/" class="tag">amiga</a>            <a href="/categories/retroprogramming/" class="tag">retroprogramming</a>          </p>
        </div>
      </article>
      <article class="card">
        <a href="/blog/2018/05/28/exploring-the-amiga-2/" class="image">
          <img src="/images/exploring-the-amiga-2.jpg" alt="exploring-the-amiga-2" />
        </a>
        <div class="card-body">
          <a href="/blog/2018/05/28/exploring-the-amiga-2/"><h2 class="card-title">Exploring the Amiga - Part 2</h2></a>
	  <p class="article-info">
            <time datetime="2018-05-28T15:00:00+01:00">May 28, 2018</time>
            <span class="fas fa-tags"></span>
            <a href="/categories/assembly/" class="tag">assembly</a>            <a href="/categories/amiga/" class="tag">amiga</a>            <a href="/categories/retroprogramming/" class="tag">retroprogramming</a>          </p>
        </div>
      </article>
      <article class="card">
        <a href="/blog/2018/05/28/exploring-the-amiga-1/" class="image">
          <img src="/images/exploring-the-amiga-1.jpg" alt="exploring-the-amiga-1" />
        </a>
        <div class="card-body">
          <a href="/blog/2018/05/28/exploring-the-amiga-1/"><h2 class="card-title">Exploring the Amiga - Part 1</h2></a>
	  <p class="article-info">
            <time datetime="2018-05-28T14:00:00+01:00">May 28, 2018</time>
            <span class="fas fa-tags"></span>
            <a href="/categories/assembly/" class="tag">assembly</a>            <a href="/categories/amiga/" class="tag">amiga</a>            <a href="/categories/retroprogramming/" class="tag">retroprogramming</a>          </p>
        </div>
      </article>
      <article class="card">
        <a href="/blog/2019/03/04/motorola-68000-addressing-modes/" class="image">
          <img src="/images/mc68000.jpg" alt="mc68000" />
        </a>
        <div class="card-body">
          <a href="/blog/2019/03/04/motorola-68000-addressing-modes/"><h2 class="card-title">Motorola 68000: addressing modes</h2></a>
	  <p class="article-info">
            <time datetime="2019-03-04T22:30:00+01:00">Mar 4, 2019</time>
            <span class="fas fa-tags"></span>
            <a href="/categories/assembly/" class="tag">assembly</a>            <a href="/categories/m68000/" class="tag">M68000</a>          </p>
        </div>
      </article>
    </div>
  </section>



  <!-- </article> -->

						</div>
					</div>

				<!-- Sidebar -->
					<div id="sidebar">
<div class="inner">
    <!-- Menu -->
        <nav id="menu">
            <header class="major">
                <h2>Menu</h2>
            </header>
<ul>
    <li><a href="/index.html">Homepage</a></li>
    <li><a href="/pages/about.html">About</a></li>
    <li><a href="/archives/index.html">Archives</a></li>
</ul>        </nav>

    <!-- Section -->
        <section>
            <header class="major">
                <h2>Categories</h2>
            </header>
<ul class="list-clean">
    <li><a href="/category/programming/">Programming</a></li>
    <li><a href="/category/projects/">Projects</a></li>
    <li><a href="/category/retro/">Retro</a></li>
</ul>
        </section>

    <!-- Section -->
        <section>
            <header class="major">
                <h2>Feeds</h2>
            </header>
<ul class="list-clean">
    <li><a href="/atom.xml"><i class="fas fa-rss"></i> All posts</a></li>


    <li><a href="/category/retro/atom.xml"><i class="fas fa-rss"></i> All posts in category: Retro</a></li>
</ul>        </section>

    <!-- Section -->
        <section>
            <header class="major">
                <h2>Tags</h2>
            </header>
<ul class="list-inline list-clean" id="tags-side">
    <li class="tag font-size-3">
        <a title="Posts about algorithms" href="/categories/algorithms/">algorithms</a>
    </li>
    <li class="tag font-size-2">
        <a title="Posts about amiga" href="/categories/amiga/">amiga</a>
    </li>
    <li class="tag font-size-4">
        <a title="Posts about AMQP" href="/categories/amqp/">AMQP</a>
    </li>
    <li class="tag font-size-3">
        <a title="Posts about architectures" href="/categories/architectures/">architectures</a>
    </li>
    <li class="tag font-size-2">
        <a title="Posts about assembly" href="/categories/assembly/">assembly</a>
    </li>
    <li class="tag font-size-2">
        <a title="Posts about AWS" href="/categories/aws/">AWS</a>
    </li>
    <li class="tag font-size-2">
        <a title="Posts about C" href="/categories/c/">C</a>
    </li>
    <li class="tag font-size-4">
        <a title="Posts about Clojure" href="/categories/clojure/">Clojure</a>
    </li>
    <li class="tag font-size-2">
        <a title="Posts about compilers" href="/categories/compilers/">compilers</a>
    </li>
    <li class="tag font-size-2">
        <a title="Posts about concurrent programming" href="/categories/concurrent-programming/">concurrent programming</a>
    </li>
    <li class="tag font-size-3">
        <a title="Posts about cryptography" href="/categories/cryptography/">cryptography</a>
    </li>
    <li class="tag font-size-2">
        <a title="Posts about decorators" href="/categories/decorators/">decorators</a>
    </li>
    <li class="tag font-size-2">
        <a title="Posts about Django" href="/categories/django/">Django</a>
    </li>
    <li class="tag font-size-3">
        <a title="Posts about Docker" href="/categories/docker/">Docker</a>
    </li>
    <li class="tag font-size-3">
        <a title="Posts about Erlang" href="/categories/erlang/">Erlang</a>
    </li>
    <li class="tag font-size-2">
        <a title="Posts about Flask" href="/categories/flask/">Flask</a>
    </li>
    <li class="tag font-size-1">
        <a title="Posts about functional programming" href="/categories/functional-programming/">functional programming</a>
    </li>
    <li class="tag font-size-3">
        <a title="Posts about generators" href="/categories/generators/">generators</a>
    </li>
    <li class="tag font-size-3">
        <a title="Posts about Git" href="/categories/git/">Git</a>
    </li>
    <li class="tag font-size-2">
        <a title="Posts about HTTP" href="/categories/http/">HTTP</a>
    </li>
    <li class="tag font-size-4">
        <a title="Posts about infrastructure" href="/categories/infrastructure/">infrastructure</a>
    </li>
    <li class="tag font-size-4">
        <a title="Posts about M68000" href="/categories/m68000/">M68000</a>
    </li>
    <li class="tag font-size-2">
        <a title="Posts about metaclasses" href="/categories/metaclasses/">metaclasses</a>
    </li>
    <li class="tag font-size-2">
        <a title="Posts about metaprogramming" href="/categories/metaprogramming/">metaprogramming</a>
    </li>
    <li class="tag font-size-3">
        <a title="Posts about Notebook" href="/categories/notebook/">Notebook</a>
    </li>
    <li class="tag font-size-1">
        <a title="Posts about OOP" href="/categories/oop/">OOP</a>
    </li>
    <li class="tag font-size-2">
        <a title="Posts about operating systems" href="/categories/operating-systems/">operating systems</a>
    </li>
    <li class="tag font-size-4">
        <a title="Posts about pelican" href="/categories/pelican/">pelican</a>
    </li>
    <li class="tag font-size-4">
        <a title="Posts about Pika" href="/categories/pika/">Pika</a>
    </li>
    <li class="tag font-size-4">
        <a title="Posts about Postage" href="/categories/postage/">Postage</a>
    </li>
    <li class="tag font-size-3">
        <a title="Posts about Postgres" href="/categories/postgres/">Postgres</a>
    </li>
    <li class="tag font-size-1">
        <a title="Posts about Python" href="/categories/python/">Python</a>
    </li>
    <li class="tag font-size-2">
        <a title="Posts about Python2" href="/categories/python2/">Python2</a>
    </li>
    <li class="tag font-size-1">
        <a title="Posts about Python3" href="/categories/python3/">Python3</a>
    </li>
    <li class="tag font-size-3">
        <a title="Posts about RabbitMQ" href="/categories/rabbitmq/">RabbitMQ</a>
    </li>
    <li class="tag font-size-4">
        <a title="Posts about refactoring" href="/categories/refactoring/">refactoring</a>
    </li>
    <li class="tag font-size-2">
        <a title="Posts about retroprogramming" href="/categories/retroprogramming/">retroprogramming</a>
    </li>
    <li class="tag font-size-4">
        <a title="Posts about RSA" href="/categories/rsa/">RSA</a>
    </li>
    <li class="tag font-size-1">
        <a title="Posts about Scala" href="/categories/scala/">Scala</a>
    </li>
    <li class="tag font-size-4">
        <a title="Posts about SSH" href="/categories/ssh/">SSH</a>
    </li>
    <li class="tag font-size-3">
        <a title="Posts about SSL" href="/categories/ssl/">SSL</a>
    </li>
    <li class="tag font-size-1">
        <a title="Posts about TDD" href="/categories/tdd/">TDD</a>
    </li>
    <li class="tag font-size-1">
        <a title="Posts about testing" href="/categories/testing/">testing</a>
    </li>
    <li class="tag font-size-3">
        <a title="Posts about versioning" href="/categories/versioning/">versioning</a>
    </li>
    <li class="tag font-size-4">
        <a title="Posts about video" href="/categories/video/">video</a>
    </li>
    <li class="tag font-size-2">
        <a title="Posts about WWW" href="/categories/www/">WWW</a>
    </li>
</ul>        </section>

    <!-- Section -->
        <section>
            <header class="major">
                <h2>Recent posts</h2>
            </header>
<div class="mini-posts">
    <article>
        <a href="/blog/2020/07/07/flask-project-setup-tdd-docker-postgres-and-more-part-3/" class="image"><img src="/images/flask-project-setup-tdd-docker-postgres-and-more-part-3.jpg" alt="flask-project-setup-tdd-docker-postgres-and-more-part-3" /></a>
        <p><strong>Flask project setup: TDD, Docker, Postgres and more - Part 3</strong> <a href="/blog/2020/07/07/flask-project-setup-tdd-docker-postgres-and-more-part-3/">Read</a></p> 
    </article>
    <article>
        <a href="/blog/2020/07/06/flask-project-setup-tdd-docker-postgres-and-more-part-2/" class="image"><img src="/images/flask-project-setup-tdd-docker-postgres-and-more-part-2.jpg" alt="flask-project-setup-tdd-docker-postgres-and-more-part-2" /></a>
        <p><strong>Flask project setup: TDD, Docker, Postgres and more - Part 2</strong> <a href="/blog/2020/07/06/flask-project-setup-tdd-docker-postgres-and-more-part-2/">Read</a></p> 
    </article>
    <article>
        <a href="/blog/2020/07/05/flask-project-setup-tdd-docker-postgres-and-more-part-1/" class="image"><img src="/images/flask-project-setup-tdd-docker-postgres-and-more-part-1.jpg" alt="flask-project-setup-tdd-docker-postgres-and-more-part-1" /></a>
        <p><strong>Flask project setup: TDD, Docker, Postgres and more - Part 1</strong> <a href="/blog/2020/07/05/flask-project-setup-tdd-docker-postgres-and-more-part-1/">Read</a></p> 
    </article>
</div>        </section>

    <!-- Section -->
        <section>
            <header class="major">
                <h2>Get in touch</h2>
            </header>
<ul class="contact">
    
    
    
    <li class="fa-twitter"><a href="https://twitter.com/thedigicat">Twitter</a></li>
    
    
    
    
    <li class="fa-github"><a href="https://github.com/TheDigitalCatOnline">GitHub</a></li>
    
</ul>        </section>

    <!-- Footer -->
        <footer id="footer">
            <p class="copyright">Editorial theme by: <a href="https://html5up.net">HTML5 UP</a>.</p>
            <p class="copyright">Cover picture by: <a href="https://pxhere.com/en/photo/1428515">An Min @ pxhere.com</a></p>
        </footer>

</div>					</div>

			</div>

		<!-- Scripts -->
			<script src="/theme/js/jquery.min.js"></script>
			<script src="/theme/js/browser.min.js"></script>
			<script src="/theme/js/breakpoints.min.js"></script>
            <script src="/theme/js/packed.js?fa89ff81"></script>

	</body>
</html>