<!DOCTYPE HTML>
<!--
	Editorial by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
	<head>
        <title>Exploring the Amiga - Part 4 - The Digital Cat</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
<meta name="description" content="The base functions of the Exec library and the MakeFunctions procedure">
<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@thedigicat" />
<meta name="twitter:title" content="Exploring the Amiga - Part 4" />
<meta name="twitter:description" content="The base functions of the Exec library and the MakeFunctions procedure" />
<meta name="twitter:image" content="https://www.thedigitalcatonline.com/images/exploring-the-amiga-4.jpg" />
		<script src="https://kit.fontawesome.com/15214b60ba.js" crossorigin="anonymous"></script>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,600,400italic,600italic|Roboto+Slab:400,700">

        <link rel="stylesheet" href="/theme/css/main.min.css?59943907">

<link rel="stylesheet" href="/theme/css/retro.min.css?d93687f1">
        
        <link href="/images/global/favicon.jpg" rel="icon">

        <!-- Google Analytics Universal -->
        <script type="text/javascript">
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
            ga('create', 'UA-74364524-1', 'auto');
            ga('send', 'pageview');
        </script>
        <!-- End Google Analytics Universal Code -->

<script type="application/ld+json">
  {
      "@context" : "https://schema.org",
      "@type" : "Article",
      "name" : "Exploring the Amiga - Part 4",
      "author" : {
	  "@type" : "Person",
	  "name" : "Leonardo Giordani"
      },
      "publisher" : {
	  "@type" : "Organization",
	  "name" : "The Digital Cat",
	  "logo" : {
	      "@type" : "ImageObject",
	      "url" : "https://www.thedigitalcatonline.com/images/global/logo_200.jpg",
	      "height" : 200,
	      "width" : 200
	  }
      },
      "mainEntityOfPage": {
	  "@type": "WebPage",
	  "@id": "https://www.thedigitalcatonline.com/blog/2018/06/14/exploring-the-amiga-4/"
      },
      "datePublished" : "14/06/2018",
      "dateModified" : "12/02/2019",
      "image" : "https://www.thedigitalcatonline.com/images/exploring-the-amiga-4.jpg",
      "description" : "The base functions of the Exec library and the MakeFunctions procedure",
      "headline" : "The base functions of the Exec library and the MakeFunctions procedure",
      "url" : "https://www.thedigitalcatonline.com/blog/2018/06/14/exploring-the-amiga-4/"
  }
</script>
	</head>
	<body class="is-preload">

		<!-- Wrapper -->
			<div id="wrapper">

				<!-- Main -->
					<div id="main">
						<div class="inner">

<header id="header">
  <a class="logo" href="/category/retro/" title="Retro">All posts in category Retro <i class="fas fa-link"></i></a>
  <div class="align-right">

    <a href="/blog/2018/06/08/exploring-the-amiga-3/"><i class="fas fa-caret-square-left"></i></a>
    
    Exploring the Amiga #4

    <a href="/blog/2018/06/25/exploring-the-amiga-5/"><i class="fas fa-caret-square-right"></i></a>

  </div>
</header>

<!-- <article class="post"> -->

  <section id="header">
    <header class="main">
      <h1>Exploring the Amiga - Part 4</h1>
    </header>
  </section>

  <section id="post-info">
    <p class="article-info">
    By Leonardo Giordani

    <span class="fas fa-calendar-alt"></span> <time datetime="2018-06-14T14:30:00+01:00"> 14/06/2018</time>

    <span class="fas fa-edit"></span> <time datetime="2019-02-12T20:00:00+00:00"> 12/02/2019</time>

    <span class="fas fa-tags"></span>
    <a class="tag" href="/categories/assembly/">assembly</a>    <a class="tag" href="/categories/amiga/">amiga</a>    <a class="tag" href="/categories/retroprogramming/">retroprogramming</a>    <br>
    Share on: <span><a class="" href="https://twitter.com/intent/tweet?text=Exploring%20the%20Amiga%20-%20Part%204&url=https%3A//www.thedigitalcatonline.com/blog/2018/06/14/exploring-the-amiga-4/&via=thedigicat&hashtags=assembly,amiga,retroprogramming" target="_blank" title="Share on Twitter"><i class="fab fa-twitter"></i> Twitter</a></span>
<span><a class="" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A//www.thedigitalcatonline.com/blog/2018/06/14/exploring-the-amiga-4/&title=Exploring%20the%20Amiga%20-%20Part%204&summary=The%20base%20functions%20of%20the%20Exec%20library%20and%20the%20MakeFunctions%20procedure&source=https%3A//www.thedigitalcatonline.com/blog/2018/06/14/exploring-the-amiga-4/" target="_blank" title="Share on LinkedIn"><i class="fab fa-linkedin"></i> LinkedIn</a></span>
<span><a class="" href="https://news.ycombinator.com/submitlink?t=Exploring%20the%20Amiga%20-%20Part%204&u=https%3A//www.thedigitalcatonline.com/blog/2018/06/14/exploring-the-amiga-4/" target="_blank" title="Share on HackerNews"><i class="fab fa-hacker-news"></i> HackerNews</a></span>
<span><a class="" href="mailto:?subject=Exploring%20the%20Amiga%20-%20Part%204&amp;body=https%3A//www.thedigitalcatonline.com/blog/2018/06/14/exploring-the-amiga-4/" target="_blank" title="Share via Email"><i class="fas fa-envelope"></i> Email</a></span>
<span><a class="" href="https://www.reddit.com/submit?url=https%3A//www.thedigitalcatonline.com/blog/2018/06/14/exploring-the-amiga-4/&title=Exploring%20the%20Amiga%20-%20Part%204" target="_blank" title="Share via Reddit"><i class="fab fa-reddit"></i> Reddit</a></span>    </p>
  </section>

  <section id="content">
    <h1 id="the-exec-base-functions">The Exec base functions<a class="headerlink" href="#the-exec-base-functions" title="Permanent link">&para;</a></h1>
<p>We found the Kickstart 1.3 (Exec 34.2) vector table at address <code>0x1a7c</code>, and the first 4 entries read</p>
<div class="highlight"><pre><span></span><code><span class="mi">00001</span><span class="n">a7c</span><span class="o">:</span> <span class="mi">08</span><span class="n">a0</span>
<span class="mi">00001</span><span class="n">a7e</span><span class="o">:</span> <span class="mi">08</span><span class="n">a8</span>
<span class="mi">00001</span><span class="n">a80</span><span class="o">:</span> <span class="mi">08</span><span class="n">ac</span>
<span class="mi">00001</span><span class="n">a82</span><span class="o">:</span> <span class="mi">08</span><span class="n">ac</span>
</code></pre></div>


<p>If we translate these relative values into absolute addresses, summing the address of the table itself, we discover the address of the 4 base functions that every Amiga library has to provide, namely <code>Open</code>, <code>Close</code>, <code>Expunge</code>, and a reserved slot that should contain a function that returns 0.</p>
<h2 id="open"><code>Open</code><a class="headerlink" href="#open" title="Permanent link">&para;</a></h2>
<p>The first value is <code>0x08a0</code>, and if we sum this value to the address of the table itself we get <code>0x1a7c + 0x08a0 = 0x231c</code>. At this address we will find the first function defined in the jump table, that is <code>Open</code>.</p>
<p>The code is the following</p>
<div class="highlight"><pre><span></span><code><span class="mi">0000231</span><span class="n">c</span><span class="o">:</span> <span class="mi">200</span><span class="n">e</span>          <span class="n">move</span><span class="o">.</span><span class="na">l</span>  <span class="n">a6</span><span class="o">,</span><span class="n">d0</span>
<span class="mi">0000231</span><span class="n">e</span><span class="o">:</span> <span class="mi">526</span><span class="n">e</span> <span class="mi">0020</span>     <span class="n">addq</span><span class="o">.</span><span class="na">w</span>  <span class="err">#</span><span class="mh">0x1</span><span class="o">,</span><span class="mh">0x20</span><span class="o">(</span><span class="n">a6</span><span class="o">)</span>
<span class="mi">00002322</span><span class="o">:</span> <span class="mi">4</span><span class="n">e75</span>          <span class="n">rts</span>
</code></pre></div>


<p>The <code>Open</code> routine expects the address of the library to be in the <code>a6</code> register, and returns the same value in <code>d0</code>. It then adds 1 to the number contained 32 bytes (<code>0x20</code>) after the address of the library itself and then returns. To find out what this number is we can go back again to the NDK and its include files.</p>
<p>From a previous investigation we know that, once the library has been installed in memory, there are two structures defined one after the other. The first is the <code>LN</code> structure that represents a linked list node, and the second is the <code>LIB</code> structure that represents the library.</p>
<p>We find the definition of <code>LN</code> in <code>include_i/exec/nodes.i</code></p>
<div class="highlight"><pre><span></span><code><span class="err"> STRUCTURE    LN,0    ; List Node</span>
<span class="err">    APTR    LN_SUCC ; Pointer to next (successor)</span>
<span class="err">    APTR    LN_PRED ; Pointer to previous (predecessor)</span>
<span class="err">    UBYTE   LN_TYPE</span>
<span class="err">    BYTE    LN_PRI  ; Priority, for sorting</span>
<span class="err">    APTR    LN_NAME ; ID string, null terminated</span>
<span class="err">    LABEL   LN_SIZE ; Note: word aligned</span>
</code></pre></div>


<p>and the definition of <code>LIB</code> in <code>include_i/exewc/libraries.i</code></p>
<div class="highlight"><pre><span></span><code><span class="err"> STRUCTURE LIB,LN_SIZE</span>
<span class="err">    UBYTE   LIB_FLAGS       ; see below</span>
<span class="err">    UBYTE   LIB_pad         ; must be zero</span>
<span class="err">    UWORD   LIB_NEGSIZE     ; number of bytes before LIB</span>
<span class="err">    UWORD   LIB_POSSIZE     ; number of bytes after LIB</span>
<span class="err">    UWORD   LIB_VERSION     ; major</span>
<span class="err">    UWORD   LIB_REVISION    ; minor</span>
<span class="err">    APTR    LIB_IDSTRING    ; ASCII identification</span>
<span class="err">    ULONG   LIB_SUM         ; the system-calculated checksum</span>
<span class="err">    UWORD   LIB_OPENCNT     ; number of current opens</span>
<span class="err">    LABEL   LIB_SIZE        ; Warning: Size is not a longword multiple!</span>
</code></pre></div>


<p>As you can see the latter mentions the former reserving space for it at the beginning (<code>LN_SIZE</code>).</p>
<p><code>LABEL</code> is a macro that creates an alias for the current size of the structure, and you can find its definition in <code>include_i/exec/types.i</code>. It works in conjunction with the type macros, which increment the global variable <code>SOFFSET</code>. The code <code>LABEL LN_SIZE</code> in the <code>LN</code> structure produces the definition <code>LN_SIZE EQU 14</code>, which is thus a simple marker and does not contribute to the size of the structure itself.</p>
<p>The comment after the <code>LABEL</code> macro in the <code>LN</code> structure says that the structure is word aligned, and indeed its size is a multiple of a word (2 bytes): 2 <code>APTR</code> (8 bytes) + 1 <code>UBYTE</code> (1 bytes) + 1 <code>BYTE</code> (1 byte) + 1 <code>APTR</code> (4 bytes) = 14 bytes.</p>
<p>To find the field updated by <code>Open</code> we need to skip 32 bytes. So, after we skip the whole <code>LN</code> structure, we still have 18 bytes to skip into the <code>LIB</code> structure. At that offset we find the <code>LIB_OPENCNT</code> field (remember that <code>UBYTE</code> is 1 byte, <code>UWORD</code> 2 bytes, and <code>APTR</code> and <code>ULONG</code> 4 bytes). This field is, as the comment reads, the "number of current opens".</p>
<p>The last instruction of the <code>Open</code> function is <code>rts</code> (ReTurn from Subroutine) that returns to the instruction after the <code>jsr</code> that called the function.</p>
<h2 id="close-expunge-and-the-reserved-slot"><code>Close</code>, <code>Expunge</code>, and the reserved slot<a class="headerlink" href="#close-expunge-and-the-reserved-slot" title="Permanent link">&para;</a></h2>
<p>Immediately after the definition of the <code>Open</code> function, we find the definition of <code>Close</code>, listed in the vector table as <code>0x08a8</code>, which becomes <code>0x1a7c + 0x08a8 = 0x2324</code>. The next two entries in the vector table contain the same value <code>0x08ac</code>, which translates to the absolute address <code>0x1a7c + 0x08ac = 0x2328</code>. This address is then the location of both the <code>Expunge</code> function and the reserved function that must return 0.</p>
<p>The code of the <code>Close</code> function is very simple, it just decrements the open counter (<code>0x20</code> in the library). There is no explicit <code>rts</code> as <code>Close</code> uses the adjacent <code>Expunge</code> code for that. Since it's impossible to remove the Exec library in the Amiga system, the <code>Expunge</code> function of the Exec library just returns 0, which is exactly what the reserved function has to do (thus the same address in the vector table), and what <code>Close</code> does after having decremented the open counter.</p>
<div class="highlight"><pre><span></span><code><span class="p">;</span> <span class="k">Close</span>
<span class="mi">00002324</span><span class="p">:</span> <span class="mi">536</span><span class="n">e</span> <span class="mi">0020</span>     <span class="n">subq</span><span class="p">.</span><span class="n">w</span>  <span class="o">#</span><span class="mi">0</span><span class="n">x1</span><span class="p">,</span><span class="mi">0</span><span class="n">x20</span><span class="p">(</span><span class="n">a6</span><span class="p">)</span>

<span class="p">;</span> <span class="n">Expunge</span>
<span class="mi">00002328</span><span class="p">:</span> <span class="mi">7000</span>          <span class="n">moveq</span>   <span class="o">#</span><span class="mi">0</span><span class="p">,</span><span class="n">d0</span>
<span class="mi">0000232</span><span class="n">a</span><span class="p">:</span> <span class="mi">4</span><span class="n">e75</span>          <span class="n">rts</span>     
</code></pre></div>


<h1 id="makefunctions"><code>MakeFunctions</code><a class="headerlink" href="#makefunctions" title="Permanent link">&para;</a></h1>
<p>The <code>MakeFunctions</code> routine is used by Exec to create the vector table at the beginning of the library when it is loaded in memory. You might recall that the vector table is created backward from the beginning of the library, thus allowing to use a simpler addressing scheme.</p>
<p>The prototype of the <code>MakeFunctions</code> routine is</p>
<div class="highlight"><pre><span></span><code>size = MakeFunctions(addess, vectors, offset)
d0                   a0      a1       a2
</code></pre></div>


<p>and the code that we found in one of the previous investigations is at offset <code>0x15b2</code></p>
<div class="highlight"><pre><span></span><code><span class="mi">000015</span><span class="n">b2</span><span class="o">:</span> <span class="mi">2</span><span class="n">f0b</span>                      <span class="n">move</span><span class="o">.</span><span class="na">l</span>  <span class="n">a3</span><span class="o">,-(</span><span class="n">sp</span><span class="o">)</span>
<span class="mi">000015</span><span class="n">b4</span><span class="o">:</span> <span class="mi">7000</span>                      <span class="n">moveq</span>   <span class="err">#</span><span class="mi">0</span><span class="o">,</span><span class="n">d0</span>
<span class="mi">000015</span><span class="n">b6</span><span class="o">:</span> <span class="mi">220</span><span class="n">a</span>                      <span class="n">move</span><span class="o">.</span><span class="na">l</span>  <span class="n">a2</span><span class="o">,</span><span class="n">d1</span>
<span class="mi">000015</span><span class="n">b8</span><span class="o">:</span> <span class="mi">6716</span>                      <span class="n">beq</span><span class="o">.</span><span class="na">b</span>   <span class="mh">0x15d0</span>
<span class="mi">000015</span><span class="n">ba</span><span class="o">:</span> <span class="mi">3219</span>                      <span class="n">move</span><span class="o">.</span><span class="na">w</span>  <span class="o">(</span><span class="n">a1</span><span class="o">)+,</span><span class="n">d1</span>
<span class="mi">000015</span><span class="n">bc</span><span class="o">:</span> <span class="mi">0</span><span class="n">c41</span> <span class="n">ffff</span>                 <span class="n">cmpi</span><span class="o">.</span><span class="na">w</span>  <span class="err">#</span><span class="o">-</span><span class="mh">0x1</span><span class="o">,</span><span class="n">d1</span>
<span class="mi">000015</span><span class="n">c0</span><span class="o">:</span> <span class="mi">6722</span>                      <span class="n">beq</span><span class="o">.</span><span class="na">b</span>   <span class="mh">0x15e4</span>
<span class="mi">000015</span><span class="n">c2</span><span class="o">:</span> <span class="mi">47</span><span class="n">f2</span> <span class="mi">1000</span>                 <span class="n">lea</span>     <span class="o">(</span><span class="mi">0</span><span class="o">,</span><span class="n">a2</span><span class="o">,</span><span class="n">d1</span><span class="o">.</span><span class="na">w</span><span class="o">),</span><span class="n">a3</span>
<span class="mi">000015</span><span class="n">c6</span><span class="o">:</span> <span class="mi">210</span><span class="n">b</span>                      <span class="n">move</span><span class="o">.</span><span class="na">l</span>  <span class="n">a3</span><span class="o">,-(</span><span class="n">a0</span><span class="o">)</span>
<span class="mi">000015</span><span class="n">c8</span><span class="o">:</span> <span class="mi">313</span><span class="n">c</span> <span class="mi">4</span><span class="n">ef9</span>                 <span class="n">move</span><span class="o">.</span><span class="na">w</span>  <span class="err">#</span><span class="mh">0x4ef9</span><span class="o">,-(</span><span class="n">a0</span><span class="o">)</span>
<span class="mi">000015</span><span class="n">cc</span><span class="o">:</span> <span class="mi">5</span><span class="n">c80</span>                      <span class="n">addq</span><span class="o">.</span><span class="na">l</span>  <span class="err">#</span><span class="mh">0x6</span><span class="o">,</span><span class="n">d0</span>
<span class="mi">000015</span><span class="n">ce</span><span class="o">:</span> <span class="mi">60</span><span class="n">ea</span>                      <span class="n">bra</span><span class="o">.</span><span class="na">b</span>   <span class="mh">0x15ba</span>
<span class="mi">000015</span><span class="n">d0</span><span class="o">:</span> <span class="mi">2219</span>                      <span class="n">move</span><span class="o">.</span><span class="na">l</span>  <span class="o">(</span><span class="n">a1</span><span class="o">)+,</span><span class="n">d1</span>
<span class="mi">000015</span><span class="n">d2</span><span class="o">:</span> <span class="mi">0</span><span class="n">c81</span> <span class="n">ffff</span> <span class="n">ffff</span>            <span class="n">cmpi</span><span class="o">.</span><span class="na">l</span>  <span class="err">#</span><span class="o">-</span><span class="mh">0x1</span><span class="o">,</span><span class="n">d1</span>
<span class="mi">000015</span><span class="n">d8</span><span class="o">:</span> <span class="mi">670</span><span class="n">a</span>                      <span class="n">beq</span><span class="o">.</span><span class="na">b</span>   <span class="mh">0x15e4</span>
<span class="mi">000015</span><span class="n">da</span><span class="o">:</span> <span class="mi">2101</span>                      <span class="n">move</span><span class="o">.</span><span class="na">l</span>  <span class="n">d1</span><span class="o">,-(</span><span class="n">a0</span><span class="o">)</span>
<span class="mi">000015</span><span class="n">dc</span><span class="o">:</span> <span class="mi">313</span><span class="n">c</span> <span class="mi">4</span><span class="n">ef9</span>                 <span class="n">move</span><span class="o">.</span><span class="na">w</span>  <span class="err">#</span><span class="mh">0x4ef9</span><span class="o">,-(</span><span class="n">a0</span><span class="o">)</span>
<span class="mi">000015</span><span class="n">e0</span><span class="o">:</span> <span class="mi">5</span><span class="n">c80</span>                      <span class="n">addq</span><span class="o">.</span><span class="na">l</span>  <span class="err">#</span><span class="mh">0x6</span><span class="o">,</span><span class="n">d0</span>
<span class="mi">000015</span><span class="n">e2</span><span class="o">:</span> <span class="mi">60</span><span class="n">ec</span>                      <span class="n">bra</span><span class="o">.</span><span class="na">b</span>   <span class="mh">0x15d0</span>
<span class="mi">000015</span><span class="n">e4</span><span class="o">:</span> <span class="mi">265</span><span class="n">f</span>                      <span class="n">movea</span><span class="o">.</span><span class="na">l</span> <span class="o">(</span><span class="n">sp</span><span class="o">)+,</span><span class="n">a3</span>
<span class="mi">000015</span><span class="n">e6</span><span class="o">:</span> <span class="mi">4</span><span class="n">e75</span>                      <span class="n">rts</span>     
</code></pre></div>


<p>The code is probably easier to read if we replace the addresses with some labels</p>
<div class="highlight"><pre><span></span><code><span class="n">Setup</span><span class="o">:</span>
<span class="mi">000015</span><span class="n">b2</span><span class="o">:</span> <span class="mi">2</span><span class="n">f0b</span>                      <span class="n">move</span><span class="o">.</span><span class="na">l</span>  <span class="n">a3</span><span class="o">,-(</span><span class="n">sp</span><span class="o">)</span>
<span class="mi">000015</span><span class="n">b4</span><span class="o">:</span> <span class="mi">7000</span>                      <span class="n">moveq</span>   <span class="err">#</span><span class="mi">0</span><span class="o">,</span><span class="n">d0</span>
<span class="mi">000015</span><span class="n">b6</span><span class="o">:</span> <span class="mi">220</span><span class="n">a</span>                      <span class="n">move</span><span class="o">.</span><span class="na">l</span>  <span class="n">a2</span><span class="o">,</span><span class="n">d1</span>
<span class="mi">000015</span><span class="n">b8</span><span class="o">:</span> <span class="mi">6716</span>                      <span class="n">beq</span><span class="o">.</span><span class="na">b</span>   <span class="n">Absolute</span>

<span class="n">Relative</span><span class="o">:</span>
<span class="mi">000015</span><span class="n">ba</span><span class="o">:</span> <span class="mi">3219</span>                      <span class="n">move</span><span class="o">.</span><span class="na">w</span>  <span class="o">(</span><span class="n">a1</span><span class="o">)+,</span><span class="n">d1</span>
<span class="mi">000015</span><span class="n">bc</span><span class="o">:</span> <span class="mi">0</span><span class="n">c41</span> <span class="n">ffff</span>                 <span class="n">cmpi</span><span class="o">.</span><span class="na">w</span>  <span class="err">#</span><span class="o">-</span><span class="mh">0x1</span><span class="o">,</span><span class="n">d1</span>
<span class="mi">000015</span><span class="n">c0</span><span class="o">:</span> <span class="mi">6722</span>                      <span class="n">beq</span><span class="o">.</span><span class="na">b</span>   <span class="n">Cleanup</span>
<span class="mi">000015</span><span class="n">c2</span><span class="o">:</span> <span class="mi">47</span><span class="n">f2</span> <span class="mi">1000</span>                 <span class="n">lea</span>     <span class="o">(</span><span class="mi">0</span><span class="o">,</span><span class="n">a2</span><span class="o">,</span><span class="n">d1</span><span class="o">.</span><span class="na">w</span><span class="o">),</span><span class="n">a3</span>
<span class="mi">000015</span><span class="n">c6</span><span class="o">:</span> <span class="mi">210</span><span class="n">b</span>                      <span class="n">move</span><span class="o">.</span><span class="na">l</span>  <span class="n">a3</span><span class="o">,-(</span><span class="n">a0</span><span class="o">)</span>
<span class="mi">000015</span><span class="n">c8</span><span class="o">:</span> <span class="mi">313</span><span class="n">c</span> <span class="mi">4</span><span class="n">ef9</span>                 <span class="n">move</span><span class="o">.</span><span class="na">w</span>  <span class="err">#</span><span class="mh">0x4ef9</span><span class="o">,-(</span><span class="n">a0</span><span class="o">)</span>
<span class="mi">000015</span><span class="n">cc</span><span class="o">:</span> <span class="mi">5</span><span class="n">c80</span>                      <span class="n">addq</span><span class="o">.</span><span class="na">l</span>  <span class="err">#</span><span class="mh">0x6</span><span class="o">,</span><span class="n">d0</span>
<span class="mi">000015</span><span class="n">ce</span><span class="o">:</span> <span class="mi">60</span><span class="n">ea</span>                      <span class="n">bra</span><span class="o">.</span><span class="na">b</span>   <span class="n">Relative</span>

<span class="n">Absolute</span><span class="o">:</span>
<span class="mi">000015</span><span class="n">d0</span><span class="o">:</span> <span class="mi">2219</span>                      <span class="n">move</span><span class="o">.</span><span class="na">l</span>  <span class="o">(</span><span class="n">a1</span><span class="o">)+,</span><span class="n">d1</span>
<span class="mi">000015</span><span class="n">d2</span><span class="o">:</span> <span class="mi">0</span><span class="n">c81</span> <span class="n">ffff</span> <span class="n">ffff</span>            <span class="n">cmpi</span><span class="o">.</span><span class="na">l</span>  <span class="err">#</span><span class="o">-</span><span class="mh">0x1</span><span class="o">,</span><span class="n">d1</span>
<span class="mi">000015</span><span class="n">d8</span><span class="o">:</span> <span class="mi">670</span><span class="n">a</span>                      <span class="n">beq</span><span class="o">.</span><span class="na">b</span>   <span class="n">Cleanup</span>
<span class="mi">000015</span><span class="n">da</span><span class="o">:</span> <span class="mi">2101</span>                      <span class="n">move</span><span class="o">.</span><span class="na">l</span>  <span class="n">d1</span><span class="o">,-(</span><span class="n">a0</span><span class="o">)</span>
<span class="mi">000015</span><span class="n">dc</span><span class="o">:</span> <span class="mi">313</span><span class="n">c</span> <span class="mi">4</span><span class="n">ef9</span>                 <span class="n">move</span><span class="o">.</span><span class="na">w</span>  <span class="err">#</span><span class="mh">0x4ef9</span><span class="o">,-(</span><span class="n">a0</span><span class="o">)</span>
<span class="mi">000015</span><span class="n">e0</span><span class="o">:</span> <span class="mi">5</span><span class="n">c80</span>                      <span class="n">addq</span><span class="o">.</span><span class="na">l</span>  <span class="err">#</span><span class="mh">0x6</span><span class="o">,</span><span class="n">d0</span>
<span class="mi">000015</span><span class="n">e2</span><span class="o">:</span> <span class="mi">60</span><span class="n">ec</span>                      <span class="n">bra</span><span class="o">.</span><span class="na">b</span>   <span class="n">Absolute</span>

<span class="n">Cleanup</span><span class="o">:</span>
<span class="mi">000015</span><span class="n">e4</span><span class="o">:</span> <span class="mi">265</span><span class="n">f</span>                      <span class="n">movea</span><span class="o">.</span><span class="na">l</span> <span class="o">(</span><span class="n">sp</span><span class="o">)+,</span><span class="n">a3</span>
<span class="mi">000015</span><span class="n">e6</span><span class="o">:</span> <span class="mi">4</span><span class="n">e75</span>                      <span class="n">rts</span>     
</code></pre></div>


<h2 id="setup">Setup<a class="headerlink" href="#setup" title="Permanent link">&para;</a></h2>
<p>The first part of the code is</p>
<div class="highlight"><pre><span></span><code><span class="n">Setup</span><span class="o">:</span>
<span class="mi">000015</span><span class="n">b2</span><span class="o">:</span> <span class="mi">2</span><span class="n">f0b</span>                      <span class="n">move</span><span class="o">.</span><span class="na">l</span>  <span class="n">a3</span><span class="o">,-(</span><span class="n">sp</span><span class="o">)</span>
<span class="mi">000015</span><span class="n">b4</span><span class="o">:</span> <span class="mi">7000</span>                      <span class="n">moveq</span>   <span class="err">#</span><span class="mi">0</span><span class="o">,</span><span class="n">d0</span>
<span class="mi">000015</span><span class="n">b6</span><span class="o">:</span> <span class="mi">220</span><span class="n">a</span>                      <span class="n">move</span><span class="o">.</span><span class="na">l</span>  <span class="n">a2</span><span class="o">,</span><span class="n">d1</span>
<span class="mi">000015</span><span class="n">b8</span><span class="o">:</span> <span class="mi">6716</span>                      <span class="n">beq</span><span class="o">.</span><span class="na">b</span>   <span class="n">Absolute</span>
</code></pre></div>


<p>The first thing this code does is to save the <code>a3</code> register in the stack because it will be changed during the routine.</p>
<div class="highlight"><pre><span></span><code><span class="n">Setup</span><span class="o">:</span>
<span class="mi">000015</span><span class="n">b2</span><span class="o">:</span> <span class="mi">2</span><span class="n">f0b</span>                      <span class="n">move</span><span class="o">.</span><span class="na">l</span>  <span class="n">a3</span><span class="o">,-(</span><span class="n">sp</span><span class="o">)</span>
</code></pre></div>


<p>In Assembly, variables are provided by registers and thus are not namespaced, as the registers are the same through the whole program. This is why you should save and restore them and document which one you will change, for instance to return values.</p>
<p>Secondly, the code sets the <code>d0</code> register to 0.</p>
<div class="highlight"><pre><span></span><code><span class="mi">000015</span><span class="n">b4</span><span class="o">:</span> <span class="mi">7000</span>                      <span class="n">moveq</span>   <span class="err">#</span><span class="mi">0</span><span class="o">,</span><span class="n">d0</span>
</code></pre></div>


<p>This register, according to the function prototype, will contain the final size of the jump table, and 0 is a sensible starting value.</p>
<p>Lastly, the code moves the <code>a2</code> register to <code>d1</code> to be able to manipulate it. </p>
<div class="highlight"><pre><span></span><code><span class="mi">000015</span><span class="n">b6</span><span class="o">:</span> <span class="mi">220</span><span class="n">a</span>                      <span class="n">move</span><span class="o">.</span><span class="na">l</span>  <span class="n">a2</span><span class="o">,</span><span class="n">d1</span>
<span class="mi">000015</span><span class="n">b8</span><span class="o">:</span> <span class="mi">6716</span>                      <span class="n">beq</span><span class="o">.</span><span class="na">b</span>   <span class="n">Absolute</span>
</code></pre></div>


<p>This, however, also sets the processor flags according to the value of <code>a2</code> itself, and those flags are used in the next <code>beq.b</code> instruction. If <code>a2</code> contains the value 0 the table is absolute (code at <code>0x15d0</code>, labelled <code>Absolute</code> here) otherwise it is relative (code at <code>0x15ba</code>, labelled <code>Relative</code> here).</p>
<h2 id="relative">Relative<a class="headerlink" href="#relative" title="Permanent link">&para;</a></h2>
<p>The second section manages relative jump vectors</p>
<div class="highlight"><pre><span></span><code><span class="n">Relative</span><span class="o">:</span>
<span class="mi">000015</span><span class="n">ba</span><span class="o">:</span> <span class="mi">3219</span>                      <span class="n">move</span><span class="o">.</span><span class="na">w</span>  <span class="o">(</span><span class="n">a1</span><span class="o">)+,</span><span class="n">d1</span>
<span class="mi">000015</span><span class="n">bc</span><span class="o">:</span> <span class="mi">0</span><span class="n">c41</span> <span class="n">ffff</span>                 <span class="n">cmpi</span><span class="o">.</span><span class="na">w</span>  <span class="err">#</span><span class="o">-</span><span class="mh">0x1</span><span class="o">,</span><span class="n">d1</span>
<span class="mi">000015</span><span class="n">c0</span><span class="o">:</span> <span class="mi">6722</span>                      <span class="n">beq</span><span class="o">.</span><span class="na">b</span>   <span class="n">Cleanup</span>
<span class="mi">000015</span><span class="n">c2</span><span class="o">:</span> <span class="mi">47</span><span class="n">f2</span> <span class="mi">1000</span>                 <span class="n">lea</span>     <span class="o">(</span><span class="mi">0</span><span class="o">,</span><span class="n">a2</span><span class="o">,</span><span class="n">d1</span><span class="o">.</span><span class="na">w</span><span class="o">),</span><span class="n">a3</span>
<span class="mi">000015</span><span class="n">c6</span><span class="o">:</span> <span class="mi">210</span><span class="n">b</span>                      <span class="n">move</span><span class="o">.</span><span class="na">l</span>  <span class="n">a3</span><span class="o">,-(</span><span class="n">a0</span><span class="o">)</span>
<span class="mi">000015</span><span class="n">c8</span><span class="o">:</span> <span class="mi">313</span><span class="n">c</span> <span class="mi">4</span><span class="n">ef9</span>                 <span class="n">move</span><span class="o">.</span><span class="na">w</span>  <span class="err">#</span><span class="mh">0x4ef9</span><span class="o">,-(</span><span class="n">a0</span><span class="o">)</span>
<span class="mi">000015</span><span class="n">cc</span><span class="o">:</span> <span class="mi">5</span><span class="n">c80</span>                      <span class="n">addq</span><span class="o">.</span><span class="na">l</span>  <span class="err">#</span><span class="mh">0x6</span><span class="o">,</span><span class="n">d0</span>
<span class="mi">000015</span><span class="n">ce</span><span class="o">:</span> <span class="mi">60</span><span class="n">ea</span>                      <span class="n">bra</span><span class="o">.</span><span class="na">b</span>   <span class="n">Relative</span>
</code></pre></div>


<p>This fetches one of the vectors from the address stored in <code>a1</code> (the address of the vector table), immediately incrementing the register value to point at the next vector.</p>
<div class="highlight"><pre><span></span><code><span class="n">Relative</span><span class="o">:</span>
<span class="mi">000015</span><span class="n">ba</span><span class="o">:</span> <span class="mi">3219</span>                      <span class="n">move</span><span class="o">.</span><span class="na">w</span>  <span class="o">(</span><span class="n">a1</span><span class="o">)+,</span><span class="n">d1</span>
</code></pre></div>


<p>then compares it with <code>0xffff</code> (or <code>#-0x1</code>) to see if we reached the end of the table. In that case the code jumps to the fourth section (<code>0x15e4</code>, labelled <code>Cleanup</code>), otherwise the execution continues with the next instruction</p>
<div class="highlight"><pre><span></span><code><span class="mi">000015</span><span class="n">bc</span><span class="o">:</span> <span class="mi">0</span><span class="n">c41</span> <span class="n">ffff</span>                 <span class="n">cmpi</span><span class="o">.</span><span class="na">w</span>  <span class="err">#</span><span class="o">-</span><span class="mh">0x1</span><span class="o">,</span><span class="n">d1</span>
<span class="mi">000015</span><span class="n">c0</span><span class="o">:</span> <span class="mi">6722</span>                      <span class="n">beq</span><span class="o">.</span><span class="na">b</span>   <span class="n">Cleanup</span>
</code></pre></div>


<p>The routine then loads the effective address of the relative vector using <code>a2</code> as the base addressing, and stores it in <code>a3</code>. This register now contains the final entry that will be part of the jump table.</p>
<div class="highlight"><pre><span></span><code><span class="mi">000015</span><span class="n">c2</span><span class="o">:</span> <span class="mi">47</span><span class="n">f2</span> <span class="mi">1000</span>                 <span class="n">lea</span>     <span class="o">(</span><span class="mi">0</span><span class="o">,</span><span class="n">a2</span><span class="o">,</span><span class="n">d1</span><span class="o">.</span><span class="na">w</span><span class="o">),</span><span class="n">a3</span>
</code></pre></div>


<p>Since the address of the jump table is contained in <code>a0</code>, the resulting absolute vector is stored there, then the code stores the value <code>0x4ef9</code> which is the code for the <code>jmp</code> instruction (more on this later)</p>
<div class="highlight"><pre><span></span><code><span class="mi">000015</span><span class="n">c6</span><span class="o">:</span> <span class="mi">210</span><span class="n">b</span>                      <span class="n">move</span><span class="o">.</span><span class="na">l</span>  <span class="n">a3</span><span class="o">,-(</span><span class="n">a0</span><span class="o">)</span>
<span class="mi">000015</span><span class="n">c8</span><span class="o">:</span> <span class="mi">313</span><span class="n">c</span> <span class="mi">4</span><span class="n">ef9</span>                 <span class="n">move</span><span class="o">.</span><span class="na">w</span>  <span class="err">#</span><span class="mh">0x4ef9</span><span class="o">,-(</span><span class="n">a0</span><span class="o">)</span>
</code></pre></div>


<p>Note that since we are storing the jump table at negative addresses starting from the library's base pointer we have to copy the argument (the address) first and then the function (the code for <code>jmp</code>). The last thing this part of the code does is to add 6 to the size of the jump table (1 word for the instruction, 2 words for the address) and then jumps back to the beginning of the loop.</p>
<div class="highlight"><pre><span></span><code><span class="mi">000015</span><span class="n">cc</span><span class="o">:</span> <span class="mi">5</span><span class="n">c80</span>                      <span class="n">addq</span><span class="o">.</span><span class="na">l</span>  <span class="err">#</span><span class="mh">0x6</span><span class="o">,</span><span class="n">d0</span>
<span class="mi">000015</span><span class="n">ce</span><span class="o">:</span> <span class="mi">60</span><span class="n">ea</span>                      <span class="n">bra</span><span class="o">.</span><span class="na">b</span>   <span class="n">Relative</span>
</code></pre></div>


<h2 id="absolute">Absolute<a class="headerlink" href="#absolute" title="Permanent link">&para;</a></h2>
<p>The third section is very similar to the second one, because it performs the same actions, only with absolute addresses instead of relative ones.</p>
<div class="highlight"><pre><span></span><code><span class="mi">000015</span><span class="n">d0</span><span class="o">:</span> <span class="mi">2219</span>                      <span class="n">move</span><span class="o">.</span><span class="na">l</span>  <span class="o">(</span><span class="n">a1</span><span class="o">)+,</span><span class="n">d1</span>
<span class="mi">000015</span><span class="n">d2</span><span class="o">:</span> <span class="mi">0</span><span class="n">c81</span> <span class="n">ffff</span> <span class="n">ffff</span>            <span class="n">cmpi</span><span class="o">.</span><span class="na">l</span>  <span class="err">#</span><span class="o">-</span><span class="mh">0x1</span><span class="o">,</span><span class="n">d1</span>
<span class="mi">000015</span><span class="n">d8</span><span class="o">:</span> <span class="mi">670</span><span class="n">a</span>                      <span class="n">beq</span><span class="o">.</span><span class="na">b</span>   <span class="n">Cleanup</span>
<span class="mi">000015</span><span class="n">da</span><span class="o">:</span> <span class="mi">2101</span>                      <span class="n">move</span><span class="o">.</span><span class="na">l</span>  <span class="n">d1</span><span class="o">,-(</span><span class="n">a0</span><span class="o">)</span>
<span class="mi">000015</span><span class="n">dc</span><span class="o">:</span> <span class="mi">313</span><span class="n">c</span> <span class="mi">4</span><span class="n">ef9</span>                 <span class="n">move</span><span class="o">.</span><span class="na">w</span>  <span class="err">#</span><span class="mh">0x4ef9</span><span class="o">,-(</span><span class="n">a0</span><span class="o">)</span>
<span class="mi">000015</span><span class="n">e0</span><span class="o">:</span> <span class="mi">5</span><span class="n">c80</span>                      <span class="n">addq</span><span class="o">.</span><span class="na">l</span>  <span class="err">#</span><span class="mh">0x6</span><span class="o">,</span><span class="n">d0</span>
<span class="mi">000015</span><span class="n">e2</span><span class="o">:</span> <span class="mi">60</span><span class="n">ec</span>                      <span class="n">bra</span><span class="o">.</span><span class="na">b</span>   <span class="n">Absolute</span>
</code></pre></div>


<p>The only difference with the previous section is that there is no need to load the effective address, as the value contained in <code>d1</code> is already absolute, so the latter can be stored directly.</p>
<h2 id="cleanup">Cleanup<a class="headerlink" href="#cleanup" title="Permanent link">&para;</a></h2>
<p>The last section simply restores the stack pointer, popping the value of the <code>a3</code> register where the pointer was previously saved, and returns to the caller.</p>
<div class="highlight"><pre><span></span><code><span class="mi">000015</span><span class="n">e4</span><span class="o">:</span> <span class="mi">265</span><span class="n">f</span>                      <span class="n">movea</span><span class="o">.</span><span class="na">l</span> <span class="o">(</span><span class="n">sp</span><span class="o">)+,</span><span class="n">a3</span>
<span class="mi">000015</span><span class="n">e6</span><span class="o">:</span> <span class="mi">4</span><span class="n">e75</span>                      <span class="n">rts</span>     
</code></pre></div>


<h1 id="self-modifying-code">Self-modifying code<a class="headerlink" href="#self-modifying-code" title="Permanent link">&para;</a></h1>
<p>The creation of the jump table performed by the <code>MakeFunctions</code> routine leverages a very powerful feature of any assembly language, that is being able to produce code that self-modifies. This feature comes from a property of machine languages called <a href="https://en.wikipedia.org/wiki/Homoiconicity">homoiconicity</a>.</p>
<p>The basic idea of homoiconicity is that the language doesn't consider data and code two different things, thus allowing to use the code as an input for routines and to change it programmatically. Pay attention that self-modifying code is just one of the implications of homoiconicity, and not its definition.</p>
<p>Homoiconicity is a feature rarely provided by languages. It is very powerful, but it basically forces to keep the language at the level of its own AST (Abstract Syntax Tree), which in turn means that you cannot add a proper abstraction, or, if you prefer, a proper high level language, if we identify with this term a computer language that is similar to the human language.</p>
<p>Famous examples of high level languages that are homoiconic are Lisp and Prolog. Lisp is a language that manages lists and its syntax is based on... lists. This means that you can pass Lisp code to a function and transform it like you would do with standard data.</p>
<p>Back to the Motorola Assembly code, the line we are interested in is </p>
<div class="highlight"><pre><span></span><code><span class="mi">000015</span><span class="n">c8</span><span class="o">:</span> <span class="mi">313</span><span class="n">c</span> <span class="mi">4</span><span class="n">ef9</span>                 <span class="n">move</span><span class="o">.</span><span class="na">w</span>  <span class="err">#</span><span class="mh">0x4ef9</span><span class="o">,-(</span><span class="n">a0</span><span class="o">)</span>
</code></pre></div>


<p>This decrements the address contained in <code>a0</code> by 2 bytes, then stores at the resulting address the hexadecimal number <code>0x4ef9</code>.</p>
<p>The interesting part is that the number <code>0x4ef9</code> has a specific meaning for the Motorola 68000 processor, and namely that of the <code>jmp</code> instruction. This is clearly shown by the tables in the Programmer's Reference Manual (Section 8, Instruction Format Summary, 8-15).</p>
<p>First we have to convert the number in binary, and we get</p>
<div class="highlight"><pre><span></span><code><span class="err">0x4ef9 -&gt; 0100 1110 1111 1001</span>
</code></pre></div>


<p>The first 10 bits (<code>0100 1110 11</code>) already identify a <code>jmp</code> instruction. The following 6 bits (<code>111 001</code>) identify the addressing mode, which in this case is <code>Absolute Long</code> or <code>(xxx).L</code> (Programmer's Reference Manual, 4-108). This instruction shall then be followed by a 4 bytes absolute address.</p>
<p>With that <code>move.w</code>, then, the code writes in memory some Assembly code. Techniques like this have been and are used by games and viruses to obfuscate the code, as a static analysis of the binary will not reveal what will be there only at runtime!</p>
<h1 id="whats-next">What's next<a class="headerlink" href="#whats-next" title="Permanent link">&para;</a></h1>
<p>The next article will discuss the reason behind the address <code>0x4</code> used for the Exec base address, and then will move on discussing linked lists and how Exec manages system resources using them.</p>
<h1 id="resources">Resources<a class="headerlink" href="#resources" title="Permanent link">&para;</a></h1>
<ul>
<li>Motorola M68000 Family Programmer's Reference Manual <a href="https://www.nxp.com/docs/en/reference-manual/M68000PRM.pdf">PDF here</a></li>
<li><a href="http://amigadev.elowar.com">AmigaOS Developer Docs</a></li>
</ul>
<h1 id="feedback">Feedback<a class="headerlink" href="#feedback" title="Permanent link">&para;</a></h1>
<p>Feel free to reach me on <a href="https://twitter.com/thedigicat">Twitter</a> if you have questions. The <a href="https://github.com/TheDigitalCatOnline/thedigitalcatonline.github.com/issues">GitHub issues</a> page is the best place to submit corrections.</p>
  </section>

  <section class="footer">
    <h1>Part 4 of the Exploring the Amiga series</h1>
    <div class="box">
      <h5>Previous articles</h5>
      <ul>
        <li><a href="/blog/2018/05/28/exploring-the-amiga-1/">Exploring the Amiga - Part 1</a></li>
        <li><a href="/blog/2018/05/28/exploring-the-amiga-2/">Exploring the Amiga - Part 2</a></li>
        <li><a href="/blog/2018/06/08/exploring-the-amiga-3/">Exploring the Amiga - Part 3</a></li>
      </ul>
      
      <h5>Next articles</h5>
      <ul>
        <li><a href="/blog/2018/06/25/exploring-the-amiga-5/">Exploring the Amiga - Part 5</a></li>
        <li><a href="/blog/2018/06/25/exploring-the-amiga-6/">Exploring the Amiga - Part 6</a></li>
        <li><a href="/blog/2019/02/19/exploring-the-amiga-7/">Exploring the Amiga - Part 7</a></li>
        <li><a href="/blog/2019/02/19/exploring-the-amiga-8/">Exploring the Amiga - Part 8</a></li>
      </ul>
    </div>
  </section>

  <section class="footer">
    <h1>Related Posts</h1>
    <div class="posts mini">
      <article class="card">
        <a href="/blog/2019/02/19/exploring-the-amiga-8/" class="image">
          <img src="/images/exploring-the-amiga-8.jpg" alt="exploring-the-amiga-8" />
        </a>
        <div class="card-body">
          <a href="/blog/2019/02/19/exploring-the-amiga-8/"><h2 class="card-title">Exploring the Amiga - Part 8</h2></a>
	  <p class="article-info">
            <time datetime="2019-02-19T14:00:00+01:00">Feb 19, 2019</time>
            <span class="fas fa-tags"></span>
            <a href="/categories/assembly/" class="tag">assembly</a>            <a href="/categories/amiga/" class="tag">amiga</a>            <a href="/categories/retroprogramming/" class="tag">retroprogramming</a>          </p>
        </div>
      </article>
      <article class="card">
        <a href="/blog/2019/02/19/exploring-the-amiga-7/" class="image">
          <img src="/images/exploring-the-amiga-7.jpg" alt="exploring-the-amiga-7" />
        </a>
        <div class="card-body">
          <a href="/blog/2019/02/19/exploring-the-amiga-7/"><h2 class="card-title">Exploring the Amiga - Part 7</h2></a>
	  <p class="article-info">
            <time datetime="2019-02-19T13:00:00+01:00">Feb 19, 2019</time>
            <span class="fas fa-tags"></span>
            <a href="/categories/assembly/" class="tag">assembly</a>            <a href="/categories/amiga/" class="tag">amiga</a>            <a href="/categories/retroprogramming/" class="tag">retroprogramming</a>          </p>
        </div>
      </article>
      <article class="card">
        <a href="/blog/2018/06/25/exploring-the-amiga-6/" class="image">
          <img src="/images/exploring-the-amiga-6.jpg" alt="exploring-the-amiga-6" />
        </a>
        <div class="card-body">
          <a href="/blog/2018/06/25/exploring-the-amiga-6/"><h2 class="card-title">Exploring the Amiga - Part 6</h2></a>
	  <p class="article-info">
            <time datetime="2018-06-25T13:00:00+01:00">Jun 25, 2018</time>
            <span class="fas fa-tags"></span>
            <a href="/categories/assembly/" class="tag">assembly</a>            <a href="/categories/amiga/" class="tag">amiga</a>            <a href="/categories/retroprogramming/" class="tag">retroprogramming</a>          </p>
        </div>
      </article>
      <article class="card">
        <a href="/blog/2018/06/25/exploring-the-amiga-5/" class="image">
          <img src="/images/exploring-the-amiga-5.jpg" alt="exploring-the-amiga-5" />
        </a>
        <div class="card-body">
          <a href="/blog/2018/06/25/exploring-the-amiga-5/"><h2 class="card-title">Exploring the Amiga - Part 5</h2></a>
	  <p class="article-info">
            <time datetime="2018-06-25T12:00:00+01:00">Jun 25, 2018</time>
            <span class="fas fa-tags"></span>
            <a href="/categories/assembly/" class="tag">assembly</a>            <a href="/categories/amiga/" class="tag">amiga</a>            <a href="/categories/retroprogramming/" class="tag">retroprogramming</a>          </p>
        </div>
      </article>
      <article class="card">
        <a href="/blog/2018/06/08/exploring-the-amiga-3/" class="image">
          <img src="/images/exploring-the-amiga-3.jpg" alt="exploring-the-amiga-3" />
        </a>
        <div class="card-body">
          <a href="/blog/2018/06/08/exploring-the-amiga-3/"><h2 class="card-title">Exploring the Amiga - Part 3</h2></a>
	  <p class="article-info">
            <time datetime="2018-06-08T12:30:00+01:00">Jun 8, 2018</time>
            <span class="fas fa-tags"></span>
            <a href="/categories/assembly/" class="tag">assembly</a>            <a href="/categories/amiga/" class="tag">amiga</a>            <a href="/categories/retroprogramming/" class="tag">retroprogramming</a>          </p>
        </div>
      </article>
      <article class="card">
        <a href="/blog/2018/05/28/exploring-the-amiga-2/" class="image">
          <img src="/images/exploring-the-amiga-2.jpg" alt="exploring-the-amiga-2" />
        </a>
        <div class="card-body">
          <a href="/blog/2018/05/28/exploring-the-amiga-2/"><h2 class="card-title">Exploring the Amiga - Part 2</h2></a>
	  <p class="article-info">
            <time datetime="2018-05-28T15:00:00+01:00">May 28, 2018</time>
            <span class="fas fa-tags"></span>
            <a href="/categories/assembly/" class="tag">assembly</a>            <a href="/categories/amiga/" class="tag">amiga</a>            <a href="/categories/retroprogramming/" class="tag">retroprogramming</a>          </p>
        </div>
      </article>
      <article class="card">
        <a href="/blog/2018/05/28/exploring-the-amiga-1/" class="image">
          <img src="/images/exploring-the-amiga-1.jpg" alt="exploring-the-amiga-1" />
        </a>
        <div class="card-body">
          <a href="/blog/2018/05/28/exploring-the-amiga-1/"><h2 class="card-title">Exploring the Amiga - Part 1</h2></a>
	  <p class="article-info">
            <time datetime="2018-05-28T14:00:00+01:00">May 28, 2018</time>
            <span class="fas fa-tags"></span>
            <a href="/categories/assembly/" class="tag">assembly</a>            <a href="/categories/amiga/" class="tag">amiga</a>            <a href="/categories/retroprogramming/" class="tag">retroprogramming</a>          </p>
        </div>
      </article>
      <article class="card">
        <a href="/blog/2019/03/04/motorola-68000-addressing-modes/" class="image">
          <img src="/images/mc68000.jpg" alt="mc68000" />
        </a>
        <div class="card-body">
          <a href="/blog/2019/03/04/motorola-68000-addressing-modes/"><h2 class="card-title">Motorola 68000: addressing modes</h2></a>
	  <p class="article-info">
            <time datetime="2019-03-04T22:30:00+01:00">Mar 4, 2019</time>
            <span class="fas fa-tags"></span>
            <a href="/categories/assembly/" class="tag">assembly</a>            <a href="/categories/m68000/" class="tag">M68000</a>          </p>
        </div>
      </article>
    </div>
  </section>



  <!-- </article> -->

						</div>
					</div>

				<!-- Sidebar -->
					<div id="sidebar">
<div class="inner">
    <!-- Menu -->
        <nav id="menu">
            <header class="major">
                <h2>Menu</h2>
            </header>
<ul>
    <li><a href="/index.html">Homepage</a></li>
    <li><a href="/pages/about.html">About</a></li>
    <li><a href="/archives/index.html">Archives</a></li>
</ul>        </nav>

    <!-- Section -->
        <section>
            <header class="major">
                <h2>Categories</h2>
            </header>
<ul class="list-clean">
    <li><a href="/category/programming/">Programming</a></li>
    <li><a href="/category/projects/">Projects</a></li>
    <li><a href="/category/retro/">Retro</a></li>
</ul>
        </section>

    <!-- Section -->
        <section>
            <header class="major">
                <h2>Feeds</h2>
            </header>
<ul class="list-clean">
    <li><a href="/atom.xml"><i class="fas fa-rss"></i> All posts</a></li>


    <li><a href="/category/retro/atom.xml"><i class="fas fa-rss"></i> All posts in category: Retro</a></li>
</ul>        </section>

    <!-- Section -->
        <section>
            <header class="major">
                <h2>Tags</h2>
            </header>
<ul class="list-inline list-clean" id="tags-side">
    <li class="tag font-size-3">
        <a title="Posts about algorithms" href="/categories/algorithms/">algorithms</a>
    </li>
    <li class="tag font-size-2">
        <a title="Posts about amiga" href="/categories/amiga/">amiga</a>
    </li>
    <li class="tag font-size-4">
        <a title="Posts about AMQP" href="/categories/amqp/">AMQP</a>
    </li>
    <li class="tag font-size-3">
        <a title="Posts about architectures" href="/categories/architectures/">architectures</a>
    </li>
    <li class="tag font-size-2">
        <a title="Posts about assembly" href="/categories/assembly/">assembly</a>
    </li>
    <li class="tag font-size-2">
        <a title="Posts about AWS" href="/categories/aws/">AWS</a>
    </li>
    <li class="tag font-size-2">
        <a title="Posts about C" href="/categories/c/">C</a>
    </li>
    <li class="tag font-size-4">
        <a title="Posts about Clojure" href="/categories/clojure/">Clojure</a>
    </li>
    <li class="tag font-size-2">
        <a title="Posts about compilers" href="/categories/compilers/">compilers</a>
    </li>
    <li class="tag font-size-2">
        <a title="Posts about concurrent programming" href="/categories/concurrent-programming/">concurrent programming</a>
    </li>
    <li class="tag font-size-3">
        <a title="Posts about cryptography" href="/categories/cryptography/">cryptography</a>
    </li>
    <li class="tag font-size-2">
        <a title="Posts about decorators" href="/categories/decorators/">decorators</a>
    </li>
    <li class="tag font-size-2">
        <a title="Posts about Django" href="/categories/django/">Django</a>
    </li>
    <li class="tag font-size-3">
        <a title="Posts about Docker" href="/categories/docker/">Docker</a>
    </li>
    <li class="tag font-size-3">
        <a title="Posts about Erlang" href="/categories/erlang/">Erlang</a>
    </li>
    <li class="tag font-size-2">
        <a title="Posts about Flask" href="/categories/flask/">Flask</a>
    </li>
    <li class="tag font-size-1">
        <a title="Posts about functional programming" href="/categories/functional-programming/">functional programming</a>
    </li>
    <li class="tag font-size-3">
        <a title="Posts about generators" href="/categories/generators/">generators</a>
    </li>
    <li class="tag font-size-3">
        <a title="Posts about Git" href="/categories/git/">Git</a>
    </li>
    <li class="tag font-size-2">
        <a title="Posts about HTTP" href="/categories/http/">HTTP</a>
    </li>
    <li class="tag font-size-4">
        <a title="Posts about infrastructure" href="/categories/infrastructure/">infrastructure</a>
    </li>
    <li class="tag font-size-4">
        <a title="Posts about M68000" href="/categories/m68000/">M68000</a>
    </li>
    <li class="tag font-size-2">
        <a title="Posts about metaclasses" href="/categories/metaclasses/">metaclasses</a>
    </li>
    <li class="tag font-size-2">
        <a title="Posts about metaprogramming" href="/categories/metaprogramming/">metaprogramming</a>
    </li>
    <li class="tag font-size-3">
        <a title="Posts about Notebook" href="/categories/notebook/">Notebook</a>
    </li>
    <li class="tag font-size-1">
        <a title="Posts about OOP" href="/categories/oop/">OOP</a>
    </li>
    <li class="tag font-size-2">
        <a title="Posts about operating systems" href="/categories/operating-systems/">operating systems</a>
    </li>
    <li class="tag font-size-4">
        <a title="Posts about pelican" href="/categories/pelican/">pelican</a>
    </li>
    <li class="tag font-size-4">
        <a title="Posts about Pika" href="/categories/pika/">Pika</a>
    </li>
    <li class="tag font-size-4">
        <a title="Posts about Postage" href="/categories/postage/">Postage</a>
    </li>
    <li class="tag font-size-3">
        <a title="Posts about Postgres" href="/categories/postgres/">Postgres</a>
    </li>
    <li class="tag font-size-1">
        <a title="Posts about Python" href="/categories/python/">Python</a>
    </li>
    <li class="tag font-size-2">
        <a title="Posts about Python2" href="/categories/python2/">Python2</a>
    </li>
    <li class="tag font-size-1">
        <a title="Posts about Python3" href="/categories/python3/">Python3</a>
    </li>
    <li class="tag font-size-3">
        <a title="Posts about RabbitMQ" href="/categories/rabbitmq/">RabbitMQ</a>
    </li>
    <li class="tag font-size-4">
        <a title="Posts about refactoring" href="/categories/refactoring/">refactoring</a>
    </li>
    <li class="tag font-size-2">
        <a title="Posts about retroprogramming" href="/categories/retroprogramming/">retroprogramming</a>
    </li>
    <li class="tag font-size-4">
        <a title="Posts about RSA" href="/categories/rsa/">RSA</a>
    </li>
    <li class="tag font-size-1">
        <a title="Posts about Scala" href="/categories/scala/">Scala</a>
    </li>
    <li class="tag font-size-4">
        <a title="Posts about SSH" href="/categories/ssh/">SSH</a>
    </li>
    <li class="tag font-size-3">
        <a title="Posts about SSL" href="/categories/ssl/">SSL</a>
    </li>
    <li class="tag font-size-1">
        <a title="Posts about TDD" href="/categories/tdd/">TDD</a>
    </li>
    <li class="tag font-size-1">
        <a title="Posts about testing" href="/categories/testing/">testing</a>
    </li>
    <li class="tag font-size-3">
        <a title="Posts about versioning" href="/categories/versioning/">versioning</a>
    </li>
    <li class="tag font-size-4">
        <a title="Posts about video" href="/categories/video/">video</a>
    </li>
    <li class="tag font-size-2">
        <a title="Posts about WWW" href="/categories/www/">WWW</a>
    </li>
</ul>        </section>

    <!-- Section -->
        <section>
            <header class="major">
                <h2>Recent posts</h2>
            </header>
<div class="mini-posts">
    <article>
        <a href="/blog/2020/07/07/flask-project-setup-tdd-docker-postgres-and-more-part-3/" class="image"><img src="/images/flask-project-setup-tdd-docker-postgres-and-more-part-3.jpg" alt="flask-project-setup-tdd-docker-postgres-and-more-part-3" /></a>
        <p><strong>Flask project setup: TDD, Docker, Postgres and more - Part 3</strong> <a href="/blog/2020/07/07/flask-project-setup-tdd-docker-postgres-and-more-part-3/">Read</a></p> 
    </article>
    <article>
        <a href="/blog/2020/07/06/flask-project-setup-tdd-docker-postgres-and-more-part-2/" class="image"><img src="/images/flask-project-setup-tdd-docker-postgres-and-more-part-2.jpg" alt="flask-project-setup-tdd-docker-postgres-and-more-part-2" /></a>
        <p><strong>Flask project setup: TDD, Docker, Postgres and more - Part 2</strong> <a href="/blog/2020/07/06/flask-project-setup-tdd-docker-postgres-and-more-part-2/">Read</a></p> 
    </article>
    <article>
        <a href="/blog/2020/07/05/flask-project-setup-tdd-docker-postgres-and-more-part-1/" class="image"><img src="/images/flask-project-setup-tdd-docker-postgres-and-more-part-1.jpg" alt="flask-project-setup-tdd-docker-postgres-and-more-part-1" /></a>
        <p><strong>Flask project setup: TDD, Docker, Postgres and more - Part 1</strong> <a href="/blog/2020/07/05/flask-project-setup-tdd-docker-postgres-and-more-part-1/">Read</a></p> 
    </article>
</div>        </section>

    <!-- Section -->
        <section>
            <header class="major">
                <h2>Get in touch</h2>
            </header>
<ul class="contact">
    
    
    
    <li class="fa-twitter"><a href="https://twitter.com/thedigicat">Twitter</a></li>
    
    
    
    
    <li class="fa-github"><a href="https://github.com/TheDigitalCatOnline">GitHub</a></li>
    
</ul>        </section>

    <!-- Footer -->
        <footer id="footer">
            <p class="copyright">Editorial theme by: <a href="https://html5up.net">HTML5 UP</a>.</p>
            <p class="copyright">Cover picture by: <a href="https://pxhere.com/en/photo/1428515">An Min @ pxhere.com</a></p>
        </footer>

</div>					</div>

			</div>

		<!-- Scripts -->
			<script src="/theme/js/jquery.min.js"></script>
			<script src="/theme/js/browser.min.js"></script>
			<script src="/theme/js/breakpoints.min.js"></script>
            <script src="/theme/js/packed.js?fa89ff81"></script>

	</body>
</html>